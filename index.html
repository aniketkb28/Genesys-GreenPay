<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>CarbonCash â€“ Carbon Footprint Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,300;9..144,500;9..144,600;9..144,700;9..144,800&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,300&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/variables.css">
<link rel="stylesheet" href="css/components.css">
<link rel="stylesheet" href="css/pages.css">
</head>
<body>

<!-- Carbon particles background -->
<div class="carbon-field" id="carbonField"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     AUTH SCREEN (Login / Sign Up)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="authScreen">
  <div class="auth-logo">
    <div class="auth-logo-icon">ğŸŒ±</div>
    <div class="auth-logo-text">CarbonCash</div>
  </div>
  <div class="auth-tagline">Track your carbon. Earn green rewards.</div>

  <div class="auth-tabs">
    <button class="auth-tab active" id="loginTab" onclick="switchAuthTab('login')">Log In</button>
    <button class="auth-tab" id="signupTab" onclick="switchAuthTab('signup')">Sign Up</button>
  </div>

  <!-- Login Form -->
  <div class="auth-form" id="loginForm">
    <div class="auth-field">
      <div class="auth-label">Username</div>
      <input class="auth-input" id="loginUsername" type="text" placeholder="Enter your username" autocomplete="username">
    </div>
    <div class="auth-field">
      <div class="auth-label">Password</div>
      <input class="auth-input" id="loginPassword" type="password" placeholder="Enter your password" autocomplete="current-password">
    </div>
    <div class="auth-error" id="loginError"></div>
    <button class="auth-btn" onclick="handleLogin()">Log In â†’</button>
  </div>

  <!-- Sign Up Form -->
  <div class="auth-form" id="signupForm" style="display:none;">
    <div class="auth-field">
      <div class="auth-label">Full Name</div>
      <input class="auth-input" id="signupName" type="text" placeholder="e.g. Priya Sharma" autocomplete="name">
    </div>
    <div class="auth-field">
      <div class="auth-label">Username</div>
      <input class="auth-input" id="signupUsername" type="text" placeholder="Choose a username" autocomplete="username">
    </div>
    <div class="auth-field">
      <div class="auth-label">Password</div>
      <input class="auth-input" id="signupPassword" type="password" placeholder="Min. 6 characters" autocomplete="new-password">
    </div>
    <div class="auth-field">
      <div class="auth-label">Confirm Password</div>
      <input class="auth-input" id="signupConfirm" type="password" placeholder="Repeat password" autocomplete="new-password">
    </div>
    <div class="auth-error" id="signupError"></div>
    <button class="auth-btn" onclick="handleSignup()">Create Account â†’</button>
  </div>

  <div class="auth-footer">Your data is stored locally on this device only.<br>No account info is sent to any server.</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app" id="mainApp" style="display:none;">
  <div class="pages">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         HOME PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page active" id="homePage">
      <div class="header">
        <div class="logo"><div class="logo-icon">ğŸŒ±</div>CarbonCash</div>
        <button class="qr-btn" id="qrBtn" title="Scan QR Code">ğŸ“·</button>
      </div>

      <div class="greeting">
        <div class="sub">Track Your Impact</div>
        <div class="name">Carbon Footprint</div>
      </div>

      <!-- Goal Setting & Green Points -->
      <div class="goal-setting-card">
        <div class="goal-setting-header">
          <div class="goal-setting-left">
            <div class="goal-setting-title">Weekly Carbon Goal</div>
            <div class="goal-setting-subtitle">Set your target and earn points</div>
          </div>
          <button class="set-goal-btn" id="setGoalBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            Edit
          </button>
        </div>
        <div class="goal-display">
          <div class="goal-amount-display">
            <span class="goal-value" id="goalValue">8.0</span>
            <span class="goal-unit">kg COâ‚‚</span>
          </div>
          <div class="green-points-badge">
            <div class="gp-icon">ğŸŒŸ</div>
            <div class="gp-info">
              <div class="gp-value" id="greenPoints">0</div>
              <div class="gp-label">Green Points</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Goal Status Alert -->
      <div class="goal-status-alert hidden" id="goalStatusAlert">
        <div class="goal-status-content">
          <div class="goal-status-icon" id="goalStatusIcon">ğŸ‰</div>
          <div class="goal-status-text">
            <div class="goal-status-title" id="goalStatusTitle">Goal Achieved!</div>
            <div class="goal-status-message" id="goalStatusMessage">You earned 50 Green Points</div>
          </div>
        </div>
      </div>

      <!-- Carbon Impact Card -->
      <div class="impact-card">
        <div class="impact-header">
          <div class="impact-left">
            <div class="impact-label">This Week's Carbon</div>
            <div class="carbon-amount">
              <span id="weekCarbon">0.0</span>
              <span class="unit">kg COâ‚‚</span>
            </div>
          </div>
          <div class="goal-ring">
            <svg width="68" height="68" viewBox="0 0 68 68">
              <circle cx="34" cy="34" r="30" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="6"/>
              <circle id="goalCircle" cx="34" cy="34" r="30" fill="none" stroke="url(#goalGradient)" stroke-width="6"
                stroke-dasharray="188.5" stroke-dashoffset="188.5" stroke-linecap="round"/>
              <defs>
                <linearGradient id="goalGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#f87171"/>
                  <stop offset="50%" style="stop-color:#fb923c"/>
                  <stop offset="100%" style="stop-color:#fbbf24"/>
                </linearGradient>
              </defs>
            </svg>
            <div class="goal-ring-label">
              <span>0%</span>
              <small>of goal</small>
            </div>
          </div>
        </div>
        <div class="goal-info">
          <div class="goal-icon">ğŸ¯</div>
          <div class="goal-text">
            <div class="main">8.0 kg away from your Green Goal</div>
            <div class="sub">Weekly target: 8kg COâ‚‚</div>
          </div>
        </div>
      </div>

      <!-- Weekly Goal Progress -->
      <div class="weekly-card" style="margin-top:24px;">
        <div class="weekly-header">
          <div class="weekly-title">Remaining Budget</div>
          <div class="weekly-badge" id="weeklyBadge">On Track</div>
        </div>
        <div class="weekly-progress">
          <div class="weekly-progress-bar" id="weeklyProgressBar" style="width:100%;"></div>
        </div>
        <div class="weekly-stats">
          <div class="weekly-stat">
            <div class="val" id="weeklyRemaining">8.0 kg</div>
            <div class="lbl">Remaining</div>
          </div>
          <div class="weekly-stat current">
            <div class="val" id="weeklyUsed">0.0 kg</div>
            <div class="lbl">Used</div>
          </div>
          <div class="weekly-stat goal">
            <div class="val" id="weeklyGoalDisplay">8.0 kg</div>
            <div class="lbl">Goal</div>
          </div>
        </div>
      </div>

      <!-- Green Points Info Card -->
      <div class="gp-info-card">
        <div class="gp-info-header">
          <div class="gp-info-icon">ğŸ’¡</div>
          <div class="gp-info-title">How Green Points Work</div>
        </div>
        <div class="gp-info-grid">
          <div class="gp-info-item low">
            <div class="gp-info-item-icon">ğŸŒ±</div>
            <div class="gp-info-item-label">Low Impact</div>
            <div class="gp-info-item-value">+6 GP/â‚¹100</div>
          </div>
          <div class="gp-info-item medium">
            <div class="gp-info-item-icon">âš–ï¸</div>
            <div class="gp-info-item-label">Medium Impact</div>
            <div class="gp-info-item-value">+2 GP/â‚¹100</div>
          </div>
          <div class="gp-info-item high">
            <div class="gp-info-item-icon">ğŸ”¥</div>
            <div class="gp-info-item-label">High Impact</div>
            <div class="gp-info-item-value">-4 GP/â‚¹100</div>
          </div>
        </div>
        <div class="gp-info-footer">Choose eco-friendly purchases to maximize your Green Points!</div>
      </div>

      <!-- Recent Transactions -->
      <div class="section-title">Recent Transactions</div>
      <div class="txn-list" id="homeTxnList">
        <div id="homeEmptyState" style="text-align:center;padding:40px 20px;color:var(--text-muted);">
          <div style="font-size:48px;margin-bottom:12px;">ğŸ“±</div>
          <div style="font-size:14px;margin-bottom:4px;">No transactions yet</div>
          <div style="font-size:12px;">Tap the QR button to simulate a purchase</div>
        </div>
      </div>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TRANSACTIONS PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="transactionsPage">
      <div class="header">
        <div class="logo"><div class="logo-icon">ğŸŒ±</div>CarbonCash</div>
        <button class="qr-btn" id="qrBtn2" title="Scan QR Code">ğŸ“·</button>
      </div>
      <div class="greeting">
        <div class="sub">All Your Purchases</div>
        <div class="name">Transactions</div>
      </div>
      <div class="filter-tabs">
        <button class="filter-tab active" data-filter="all">All</button>
        <button class="filter-tab" data-filter="high">High Impact</button>
        <button class="filter-tab" data-filter="medium">Medium</button>
        <button class="filter-tab" data-filter="low">Low Impact</button>
      </div>
      <div class="section-title">This Week</div>
      <div class="txn-list" id="transactionsTxnList">
        <div id="txnsEmptyState" style="text-align:center;padding:40px 20px;color:var(--text-muted);">
          <div style="font-size:48px;margin-bottom:12px;">ğŸ“±</div>
          <div style="font-size:14px;margin-bottom:4px;">No transactions yet</div>
          <div style="font-size:12px;">Tap the QR button to simulate a purchase</div>
        </div>
      </div>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         INSIGHTS PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="insightsPage">
      <div class="header">
        <div class="logo"><div class="logo-icon">ğŸŒ±</div>CarbonCash</div>
        <button class="qr-btn" id="qrBtn3" title="Scan QR Code">ğŸ“·</button>
      </div>
      <div class="greeting">
        <div class="sub">Environmental Analytics</div>
        <div class="name">Insights</div>
      </div>

      <div class="insight-card">
        <div class="insight-header">
          <div class="insight-title">Weekly Carbon Footprint</div>
          <div class="insight-value" id="insightsWeeklyTotal">0 kg COâ‚‚</div>
        </div>
        <div class="insight-chart" id="weeklyChart">
          <div style="text-align:center;padding:40px 20px;color:var(--text-muted);">
            <div style="font-size:36px;margin-bottom:8px;">ğŸ“Š</div>
            <div style="font-size:13px;">No transactions yet â€” tap ğŸ“· to add one</div>
          </div>
        </div>
      </div>

      <div class="section-title">Carbon by Category</div>
      <div class="category-list" id="categoryList">
        <div style="text-align:center;padding:32px 20px;color:var(--text-muted);">
          <div style="font-size:36px;margin-bottom:8px;">ğŸ“Š</div>
          <div style="font-size:13px;">No transactions yet â€” tap ğŸ“· to add one</div>
        </div>
      </div>

      <div class="section-title">Your Impact</div>
      <div class="comparison-card" id="comparisonCard">
        <div class="comp-header">
          <div class="comp-title">vs Average User</div>
          <div class="comp-badge good" id="compBadge">-% Better</div>
        </div>
        <div class="comp-bars">
          <div class="comp-bar-row">
            <div class="comp-label">You</div>
            <div class="comp-bar"><div class="comp-bar-fill yours" style="width:0%;" id="yourBar"></div></div>
            <div class="comp-val" id="yourCarbon">0 kg</div>
          </div>
          <div class="comp-bar-row">
            <div class="comp-label">Average</div>
            <div class="comp-bar"><div class="comp-bar-fill avg" style="width:100%;"></div></div>
            <div class="comp-val" id="avgCarbon">8.0 kg</div>
          </div>
        </div>
        <div class="comp-tip" id="compTip">ğŸŒŸ Start adding transactions to see how you compare!</div>
      </div>

      <div class="section-title">Achievements</div>
      <div class="achievement-grid">
        <div class="achievement-card" id="achEcoStarter">
          <div class="ach-icon">ğŸŒ±</div>
          <div class="ach-name">Eco Starter</div>
          <div class="ach-desc">First transaction tracked</div>
        </div>
        <div class="achievement-card" id="achGoalGetter">
          <div class="ach-icon">ğŸ¯</div>
          <div class="ach-name">Goal Getter</div>
          <div class="ach-desc">Met weekly goal</div>
        </div>
        <div class="achievement-card" id="achSpendWise">
          <div class="ach-icon">ğŸ’°</div>
          <div class="ach-name">Spend Wise</div>
          <div class="ach-desc">5+ transactions tracked</div>
        </div>
        <div class="achievement-card" id="achPointCollector">
          <div class="ach-icon">â­</div>
          <div class="ach-name">Point Collector</div>
          <div class="ach-desc">Earned 50+ GP</div>
        </div>
      </div>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PROFILE PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="profilePage">
      <div class="header">
        <div class="logo"><div class="logo-icon">ğŸŒ±</div>CarbonCash</div>
        <button class="qr-btn" id="qrBtn4" title="Scan QR Code">ğŸ“·</button>
      </div>
      <div class="greeting">
        <div class="sub">Your Account</div>
        <div class="name">Profile</div>
      </div>

      <div class="profile-header">
        <div class="profile-avatar">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
          </svg>
        </div>
        <div class="profile-info">
          <div class="profile-name">User</div>
          <div class="profile-email">@username</div>
        </div>
        <button class="edit-btn" id="editProfileBtn">Edit</button>
      </div>

      <div class="profile-stats">
        <div class="stat-box">
          <div class="stat-icon">ğŸŒ±</div>
          <div class="stat-num" id="profileTotalCarbon">0</div>
          <div class="stat-label">Total COâ‚‚ (kg)</div>
        </div>
        <div class="stat-box">
          <div class="stat-icon">ğŸ¯</div>
          <div class="stat-num">12</div>
          <div class="stat-label">Goals Met</div>
        </div>
        <div class="stat-box">
          <div class="stat-icon">ğŸ†</div>
          <div class="stat-num">8</div>
          <div class="stat-label">Achievements</div>
        </div>
      </div>

      <div class="section-title">Settings</div>
      <div class="menu-list">
        <div class="menu-item"><div class="menu-icon">ğŸ¯</div><div class="menu-text"><div class="menu-title">Carbon Goals</div><div class="menu-subtitle">Set your weekly targets</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ””</div><div class="menu-text"><div class="menu-title">Notifications</div><div class="menu-subtitle">Manage alerts & reminders</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ”—</div><div class="menu-text"><div class="menu-title">Linked Accounts</div><div class="menu-subtitle">3 cards connected</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸŒ</div><div class="menu-text"><div class="menu-title">Offset Programs</div><div class="menu-subtitle">Plant trees & support projects</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item" id="exportDataBtn" style="cursor:pointer;" onclick="exportToCSV()"><div class="menu-icon">ğŸ“Š</div><div class="menu-text"><div class="menu-title">Export Data</div><div class="menu-subtitle">Download your carbon history as CSV</div></div><div class="menu-arrow">â¬‡ï¸</div></div>
        <div class="menu-item" id="deleteDataBtn" style="cursor:pointer;" onclick="showDeleteConfirm()"><div class="menu-icon">ğŸ—‘ï¸</div><div class="menu-text"><div class="menu-title" style="color:var(--red);">Delete All Data</div><div class="menu-subtitle">Permanently erase all saved data & CSV</div></div><div class="menu-arrow" style="color:var(--red);">â€º</div></div>
      </div>

      <div class="section-title">Support</div>
      <div class="menu-list">
        <div class="menu-item"><div class="menu-icon">â“</div><div class="menu-text"><div class="menu-title">Help & FAQ</div><div class="menu-subtitle">Get answers to common questions</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ’¬</div><div class="menu-text"><div class="menu-title">Contact Support</div><div class="menu-subtitle">We're here to help</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">â­</div><div class="menu-text"><div class="menu-title">Rate CarbonCash</div><div class="menu-subtitle">Share your feedback</div></div><div class="menu-arrow">â€º</div></div>
      </div>

      <div class="section-title">Legal</div>
      <div class="menu-list">
        <div class="menu-item"><div class="menu-icon">ğŸ“„</div><div class="menu-text"><div class="menu-title">Privacy Policy</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ“‹</div><div class="menu-text"><div class="menu-title">Terms of Service</div></div><div class="menu-arrow">â€º</div></div>
      </div>

      <button class="logout-btn" id="logoutBtn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"/>
        </svg>
        Log Out
      </button>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         ECO MERCHANTS PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="merchantsPage">
      <div class="header">
        <div class="logo"><div class="logo-icon">ğŸª</div>Eco Merchants</div>
        <button class="qr-btn" id="qrBtn3b" title="Scan QR Code">ğŸ“·</button>
      </div>
      <div class="greeting">
        <div class="sub">Discover sustainable partners</div>
        <div class="name" style="font-size:22px;">Earn rewards for green purchases</div>
      </div>

      <div class="section-title">Featured Merchants</div>
      <div style="padding:0 20px;">

        <div class="merchant-card" onclick="showMerchantDetail('solar')">
          <div class="merchant-header">
            <div class="merchant-logo">â˜€ï¸</div>
            <div class="merchant-info">
              <div class="merchant-name">SolarPro Solutions</div>
              <div class="merchant-category">Renewable Energy</div>
              <div class="merchant-rating"><span class="stars">â­â­â­â­â­</span><span class="rating-count">(2.4k)</span></div>
            </div>
          </div>
          <div class="merchant-offer"><div class="offer-text">ğŸ Earn 30 GP per â‚¹100 spent</div><div class="offer-desc">Plus 15% discount with 200+ GP</div></div>
          <div class="merchant-stats">
            <div class="merchant-stat"><span class="merchant-stat-value">30</span><span class="merchant-stat-label">GP/Purchase</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">15%</span><span class="merchant-stat-label">Max Discount</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">4.8k</span><span class="merchant-stat-label">Users</span></div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('solar')">Visit Store</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('SolarPro Solutions')">ğŸ’š Save</div>
          </div>
        </div>

        <div class="merchant-card" onclick="showMerchantDetail('ev')">
          <div class="merchant-header">
            <div class="merchant-logo">âš¡</div>
            <div class="merchant-info">
              <div class="merchant-name">EcoCharge Network</div>
              <div class="merchant-category">EV Charging</div>
              <div class="merchant-rating"><span class="stars">â­â­â­â­â­</span><span class="rating-count">(1.8k)</span></div>
            </div>
          </div>
          <div class="merchant-offer"><div class="offer-text">ğŸ Earn 5 GP per charge session</div><div class="offer-desc">Free charging with 150+ GP</div></div>
          <div class="merchant-stats">
            <div class="merchant-stat"><span class="merchant-stat-value">5</span><span class="merchant-stat-label">GP/Session</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">100%</span><span class="merchant-stat-label">Free Charge</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">2.1k</span><span class="merchant-stat-label">Stations</span></div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('ev')">Find Station</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('EcoCharge Network')">ğŸ’š Save</div>
          </div>
        </div>

        <div class="merchant-card" onclick="showMerchantDetail('grocer')">
          <div class="merchant-header">
            <div class="merchant-logo">ğŸŒ¿</div>
            <div class="merchant-info">
              <div class="merchant-name">GreenGrocer Market</div>
              <div class="merchant-category">Organic Food</div>
              <div class="merchant-rating"><span class="stars">â­â­â­â­â˜†</span><span class="rating-count">(3.2k)</span></div>
            </div>
          </div>
          <div class="merchant-offer"><div class="offer-text">ğŸ Earn 2 GP per â‚¹10 spent</div><div class="offer-desc">10% discount on organic produce with 100+ GP</div></div>
          <div class="merchant-stats">
            <div class="merchant-stat"><span class="merchant-stat-value">20</span><span class="merchant-stat-label">GP/Week Avg</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">10%</span><span class="merchant-stat-label">Discount</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">45</span><span class="merchant-stat-label">Locations</span></div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('grocer')">Shop Now</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('GreenGrocer Market')">ğŸ’š Save</div>
          </div>
        </div>

        <div class="merchant-card" onclick="showMerchantDetail('bike')">
          <div class="merchant-header">
            <div class="merchant-logo">ğŸš´</div>
            <div class="merchant-info">
              <div class="merchant-name">BikeShare City</div>
              <div class="merchant-category">Green Transport</div>
              <div class="merchant-rating"><span class="stars">â­â­â­â­â­</span><span class="rating-count">(5.1k)</span></div>
            </div>
          </div>
          <div class="merchant-offer"><div class="offer-text">ğŸ Earn 3 GP per ride</div><div class="offer-desc">Monthly pass discount with 80+ GP</div></div>
          <div class="merchant-stats">
            <div class="merchant-stat"><span class="merchant-stat-value">3</span><span class="merchant-stat-label">GP/Ride</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">20%</span><span class="merchant-stat-label">Pass Discount</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">300+</span><span class="merchant-stat-label">Stations</span></div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('bike')">Find Bike</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('BikeShare City')">ğŸ’š Save</div>
          </div>
        </div>

        <div class="merchant-card" onclick="showMerchantDetail('recycle')">
          <div class="merchant-header">
            <div class="merchant-logo">â™»ï¸</div>
            <div class="merchant-info">
              <div class="merchant-name">RecycleHub</div>
              <div class="merchant-category">Waste Management</div>
              <div class="merchant-rating"><span class="stars">â­â­â­â­â­</span><span class="rating-count">(4.3k)</span></div>
            </div>
          </div>
          <div class="merchant-offer"><div class="offer-text">ğŸ Earn 10 GP per recycling drop-off</div><div class="offer-desc">Bonus rewards for electronics recycling</div></div>
          <div class="merchant-stats">
            <div class="merchant-stat"><span class="merchant-stat-value">10</span><span class="merchant-stat-label">GP/Drop-off</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">50</span><span class="merchant-stat-label">Bonus GP</span></div>
            <div class="merchant-stat"><span class="merchant-stat-value">120</span><span class="merchant-stat-label">Centers</span></div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('recycle')">Find Center</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('RecycleHub')">ğŸ’š Save</div>
          </div>
        </div>

      </div>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         REWARDS PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="rewardsPage">
      <div class="header">
        <div class="logo"><div class="logo-icon">ğŸ</div>Rewards</div>
        <button class="qr-btn" id="qrBtn4b" title="Scan QR Code">ğŸ“·</button>
      </div>
      <div class="greeting">
        <div class="sub">Your Green Points</div>
        <div class="name" style="font-size:32px;"><span id="rewardsGP">0</span> GP</div>
      </div>

      <div class="section-title">Green Investment Discounts</div>
      <div style="padding:0 20px;">

        <div class="investment-card" onclick="showInvestmentDetail('solar', 100)">
          <div class="investment-header">
            <div><div class="investment-title">Solar Panel Installation</div><div class="investment-subtitle">Clean energy for your home</div></div>
            <div class="investment-badge">ğŸ”¥ Popular</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail"><div class="investment-detail-label">Cost</div><div class="investment-detail-value">100 GP</div></div>
            <div class="investment-detail"><div class="investment-detail-label">You Save</div><div class="investment-detail-value">10%</div></div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('solar', 100)"><div class="investment-cta-text">Redeem Discount â†’</div></div>
        </div>

        <div class="investment-card" onclick="showInvestmentDetail('ev-charging', 150)">
          <div class="investment-header">
            <div><div class="investment-title">EV Charging Station</div><div class="investment-subtitle">Home charging solution</div></div>
            <div class="investment-badge">âš¡ New</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail"><div class="investment-detail-label">Cost</div><div class="investment-detail-value">150 GP</div></div>
            <div class="investment-detail"><div class="investment-detail-label">You Save</div><div class="investment-detail-value">15%</div></div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('ev-charging', 150)"><div class="investment-cta-text">Redeem Discount â†’</div></div>
        </div>

        <div class="investment-card" onclick="showInvestmentDetail('wind-energy', 200)">
          <div class="investment-header">
            <div><div class="investment-title">Wind Energy Subscription</div><div class="investment-subtitle">100% renewable electricity</div></div>
            <div class="investment-badge">ğŸ’š Eco</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail"><div class="investment-detail-label">Cost</div><div class="investment-detail-value">200 GP</div></div>
            <div class="investment-detail"><div class="investment-detail-label">You Save</div><div class="investment-detail-value">20%</div></div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('wind-energy', 200)"><div class="investment-cta-text">Redeem Discount â†’</div></div>
        </div>

        <div class="investment-card" onclick="showInvestmentDetail('green-bonds', 300)">
          <div class="investment-header">
            <div><div class="investment-title">Green Bond Investment</div><div class="investment-subtitle">Support eco projects</div></div>
            <div class="investment-badge">ğŸ“ˆ Premium</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail"><div class="investment-detail-label">Cost</div><div class="investment-detail-value">300 GP</div></div>
            <div class="investment-detail"><div class="investment-detail-label">Bonus APY</div><div class="investment-detail-value">+2%</div></div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('green-bonds', 300)"><div class="investment-cta-text">Redeem Bonus â†’</div></div>
        </div>

        <div class="investment-card" onclick="showInvestmentDetail('carbon-offset', 80)">
          <div class="investment-header">
            <div><div class="investment-title">Carbon Offset Credits</div><div class="investment-subtitle">Neutralize your footprint</div></div>
            <div class="investment-badge">ğŸŒ Impact</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail"><div class="investment-detail-label">Cost</div><div class="investment-detail-value">80 GP</div></div>
            <div class="investment-detail"><div class="investment-detail-label">Credits</div><div class="investment-detail-value">5 tons</div></div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('carbon-offset', 80)"><div class="investment-cta-text">Purchase Credits â†’</div></div>
        </div>

      </div>

      <div class="section-title" style="margin-top:8px;">Lifestyle Rewards</div>
      <div style="padding:0 20px;">
        <div class="rewards-grid">
          <div class="reward-card" onclick="showRewardDetail('coffee', 25)">
            <span class="reward-icon">â˜•</span>
            <div class="reward-title">Coffee Voucher</div>
            <div class="reward-desc">â‚¹400 at eco-friendly cafÃ©s</div>
            <span class="reward-cost">ğŸ’° 25 GP</span>
          </div>
          <div class="reward-card" onclick="showRewardDetail('bike-rental', 40)">
            <span class="reward-icon">ğŸš²</span>
            <div class="reward-title">Bike Rental</div>
            <div class="reward-desc">1 week free rental</div>
            <span class="reward-cost">ğŸ’° 40 GP</span>
          </div>
          <div class="reward-card" onclick="showRewardDetail('transit', 120)">
            <span class="reward-icon">ğŸš‡</span>
            <div class="reward-title">Transit Pass</div>
            <div class="reward-desc">1 month unlimited rides</div>
            <span class="reward-cost">ğŸ’° 120 GP</span>
          </div>
          <div class="reward-card" onclick="showRewardDetail('organic', 60)">
            <span class="reward-icon">ğŸ¥—</span>
            <div class="reward-title">Organic Box</div>
            <div class="reward-desc">Fresh organic produce</div>
            <span class="reward-cost">ğŸ’° 60 GP</span>
          </div>
        </div>
      </div>
      <div style="height:20px;"></div>
    </div>

  </div>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <button class="nav-item active" data-page="homePage"><div class="nav-icon">ğŸ </div><div class="nav-label">Home</div></button>
    <button class="nav-item" data-page="transactionsPage"><div class="nav-icon">ğŸ’³</div><div class="nav-label">Activity</div></button>
    <button class="nav-item" data-page="merchantsPage"><div class="nav-icon">ğŸª</div><div class="nav-label">Merchants</div></button>
    <button class="nav-item" data-page="rewardsPage"><div class="nav-icon">ğŸ</div><div class="nav-label">Rewards</div></button>
    <button class="nav-item" data-page="insightsPage"><div class="nav-icon">ğŸ“Š</div><div class="nav-label">Insights</div></button>
    <button class="nav-item" data-page="profilePage"><div class="nav-icon">ğŸ‘¤</div><div class="nav-label">Profile</div></button>
  </div>
</div>

<!-- Delete Data Confirmation Modal -->
<div class="modal" id="deleteModal" style="z-index:4000;">
  <div class="modal-sheet" id="deleteModalSheet" style="max-height:340px;">
    <div class="modal-handle"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-icon-big high" style="background:rgba(248,113,113,.15);border:1.5px solid rgba(248,113,113,.35);"><span>ğŸ—‘ï¸</span></div>
        <div class="modal-info">
          <h3 style="color:var(--red);">Delete All Data?</h3>
          <div class="cat">This cannot be undone</div>
        </div>
      </div>
      <p style="font-size:13px;color:var(--text-muted);line-height:1.6;margin:16px 0;">
        This will permanently erase your <strong style="color:var(--text-pri);">transaction history, green points, claimed rewards, weekly goal</strong> and the saved CSV file from this device.
      </p>
      <div style="display:flex;gap:12px;margin-top:8px;">
        <button class="modal-close" id="deleteCancelBtn" style="background:rgba(255,255,255,.05);box-shadow:none;flex:1;font-size:14px;">Cancel</button>
        <button id="deleteConfirmBtn" style="flex:2;padding:16px;border-radius:14px;border:none;background:rgba(248,113,113,.2);border:1.5px solid rgba(248,113,113,.4);color:#f87171;font-size:14px;font-weight:700;cursor:pointer;transition:all .2s;">Yes, Delete Everything</button>
      </div>
    </div>
  </div>
</div>

<!-- Toast Notification Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Detail Info Modal (rewards / merchants) -->
<div class="detail-modal" id="detailModal">
  <div class="detail-modal-content">
    <div class="detail-modal-header">
      <div style="flex:1;">
        <div class="detail-modal-icon" id="detailIcon">â˜€ï¸</div>
        <div class="detail-modal-title" id="detailTitle">Title</div>
        <div class="detail-modal-subtitle" id="detailSubtitle">Subtitle</div>
      </div>
      <div class="detail-modal-close" onclick="closeDetailModal()">âœ•</div>
    </div>
    <div id="detailClaimedBadge" class="claimed-badge" style="display:none;"><div class="claimed-badge-text">âœ“ Already Claimed</div></div>
    <div id="detailStatsSection" class="detail-stats" style="display:none;"></div>
    <div class="detail-section">
      <div class="detail-section-title">Description</div>
      <div class="detail-section-content" id="detailDescription"></div>
    </div>
    <div class="detail-section" id="detailFeaturesSection" style="display:none;">
      <div class="detail-section-title">Features & Benefits</div>
      <div class="detail-feature-list" id="detailFeatures"></div>
    </div>
    <div class="detail-section" id="detailTermsSection" style="display:none;">
      <div class="detail-section-title">Terms & Conditions</div>
      <div class="detail-section-content" id="detailTerms"></div>
    </div>
    <div class="detail-actions" id="detailActions"></div>
  </div>
</div>

<!-- Transaction Detail Modal -->
<div class="modal" id="txnModal">
  <div class="modal-sheet" id="txnModalSheet">
    <div class="modal-handle"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-icon-big high" id="modalIconBig"><span id="modalEmoji">â˜•</span></div>
        <div class="modal-info">
          <h3 id="modalName">Merchant</h3>
          <div class="cat" id="modalCat">Category Â· MCC</div>
        </div>
      </div>
      <div class="modal-row"><div class="label">Transaction Amount</div><div class="value" id="modalAmount">â‚¹0</div></div>
      <div class="modal-row"><div class="label">Carbon Footprint</div><div class="value carbon" id="modalCarbon">0 kg COâ‚‚</div></div>
      <div class="modal-row"><div class="label">Transaction Date</div><div class="value" id="modalDate">â€”</div></div>
      <div class="modal-divider"></div>
      <div class="carbon-breakdown" id="carbonBreakdown"><div class="breakdown-title">Carbon Breakdown</div></div>
      <div class="tip-box">
        <div class="tip-icon">ğŸ’¡</div>
        <div class="tip-text" id="modalTip"><strong>Eco Tip:</strong> Small choices add up.</div>
      </div>
      <button class="modal-close" id="modalCloseBtn">Close</button>
    </div>
  </div>
</div>

<!-- Goal Setting Modal -->
<div class="modal" id="goalModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-icon-big" style="background:linear-gradient(135deg,rgba(74,222,128,.2),rgba(34,197,94,.2));border:1.5px solid rgba(74,222,128,.35);"><span>ğŸ¯</span></div>
        <div class="modal-info"><h3>Set Weekly Goal</h3><div class="cat">Choose your carbon limit</div></div>
      </div>
      <div style="margin:20px 0;">
        <div style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">Target Carbon Footprint (kg COâ‚‚)</div>
        <input type="number" id="goalInput" class="goal-input" min="1" max="100" step="0.5" value="8.0" placeholder="8.0">
        <div class="goal-suggestions">
          <button class="goal-suggest-btn" data-goal="5">5 kg â€“ Strict</button>
          <button class="goal-suggest-btn" data-goal="8">8 kg â€“ Moderate</button>
          <button class="goal-suggest-btn" data-goal="12">12 kg â€“ Flexible</button>
        </div>
      </div>
      <div style="display:flex;gap:12px;">
        <button class="modal-close" id="goalCancelBtn" style="background:rgba(255,255,255,.05);box-shadow:none;flex:1;">Cancel</button>
        <button class="modal-close" id="goalSaveBtn" style="flex:2;">Save Goal</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCRIPTS (load order matters)
     1. state    â€“ variables & storage helpers
     2. auth     â€“ login/signup (uses state, refs UI)
     3. transactions â€“ txn logic & modal
     4. insights â€“ charts, goals, achievements
     5. rewards  â€“ reward/merchant data & modals
     6. app      â€“ navigation, QR, toast, CSV, delete
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script src="js/state.js"></script>
<script src="js/auth.js"></script>
<script src="js/transactions.js"></script>
<script src="js/insights.js"></script>
<script src="js/rewards.js"></script>
<script src="js/app.js"></script>

</body>
</html>
