<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>CarbonCash ‚Äì Gamified Carbon Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,300;9..144,500;9..144,600;9..144,700;9..144,800&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,300&display=swap" rel="stylesheet">
<style>
:root {
  --bg-deep:    #050e08;
  --bg-card:    #0b1a0f;
  --bg-glass:   rgba(14,30,18,0.88);
  --green-glow: #22c55e;
  --green-mid:  #16a34a;
  --green-dark: #14532d;
  --leaf-light: #4ade80;
  --leaf-pale:  #86efac;
  --gold:       #fbbf24;
  --gold-dark:  #d97706;
  --red:        #f87171;
  --orange:     #fb923c;
  --blue:       #38bdf8;
  --text-pri:   #e8fced;
  --text-muted: #6b9a7a;
  --border:     rgba(34,197,94,0.13);
  --r:          22px;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{background:var(--bg-deep);color:var(--text-pri);font-family:'DM Sans',sans-serif;width:100%;height:100%;overflow:hidden;}

/* ‚îÄ‚îÄ Ambient BG ‚îÄ‚îÄ */
body::before{content:'';position:fixed;inset:0;background:
  radial-gradient(ellipse 55% 45% at 20% -5%,rgba(22,163,74,.16) 0%,transparent 65%),
  radial-gradient(ellipse 45% 55% at 80% 105%,rgba(20,83,45,.25) 0%,transparent 60%);
  pointer-events:none;z-index:0;}

/* ‚îÄ‚îÄ Carbon particles floating ‚îÄ‚îÄ */
.carbon-field{position:fixed;inset:0;pointer-events:none;z-index:1;overflow:hidden;}
.carbon-particle{position:absolute;opacity:0;animation:floatCarbon linear infinite;}
@keyframes floatCarbon{
  0%  {transform:translateY(110vh) translateX(0) rotate(0deg) scale(.8);opacity:0;}
  6%  {opacity:.3;}
  90% {opacity:.15;}
  100%{transform:translateY(-15vh) translateX(40px) rotate(380deg) scale(.5);opacity:0;}
}

/* ‚îÄ‚îÄ App shell ‚îÄ‚îÄ */
.app{position:fixed;inset:0;z-index:2;max-width:430px;margin:0 auto;display:flex;flex-direction:column;box-shadow:0 0 60px rgba(0,0,0,.8);}

/* ‚îÄ‚îÄ Page system ‚îÄ‚îÄ */
.pages{flex:1;min-height:0;position:relative;overflow:hidden;}
.page{position:absolute;inset:0;overflow-y:auto;overflow-x:hidden;padding-bottom:12px;
  opacity:0;transform:translateX(30px);pointer-events:none;-webkit-overflow-scrolling:touch;
  transition:opacity .35s cubic-bezier(.4,0,.2,1),transform .35s cubic-bezier(.4,0,.2,1);}
.page.active{opacity:1;transform:translateX(0);pointer-events:all;}

/* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
.header{padding:16px 24px 0;display:flex;justify-content:space-between;align-items:center;}
.logo{display:flex;align-items:center;gap:8px;font-family:'Fraunces',serif;
  font-size:24px;font-weight:600;color:var(--leaf-light);letter-spacing:-.5px;}
.logo-icon{width:34px;height:34px;background:linear-gradient(135deg,#16a34a,#4ade80);
  border-radius:10px;display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 18px rgba(74,222,128,.35);animation:logoPulse 3s ease-in-out infinite;}
@keyframes logoPulse{0%,100%{box-shadow:0 0 18px rgba(74,222,128,.35);}50%{box-shadow:0 0 32px rgba(74,222,128,.6),0 0 60px rgba(74,222,128,.2);}}
.qr-btn{width:38px;height:38px;border-radius:12px;background:var(--bg-glass);
  border:1px solid var(--border);display:flex;align-items:center;justify-content:center;
  cursor:pointer;backdrop-filter:blur(10px);position:relative;transition:transform .2s;}
.qr-btn:hover{transform:scale(1.08);}

/* ‚îÄ‚îÄ Greeting ‚îÄ‚îÄ */
.greeting{padding:18px 24px 0;}
.greeting .sub{font-size:13px;color:var(--text-muted);margin-bottom:3px;}
.greeting .name{font-family:'Fraunces',serif;font-size:28px;font-weight:700;
  background:linear-gradient(90deg,#4ade80,#86efac,#d4a853);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}

/* ‚îÄ‚îÄ Green Points Header Card ‚îÄ‚îÄ */
.points-header-card{margin:16px 20px 0;
  background:linear-gradient(135deg,rgba(251,191,36,.2),rgba(217,119,6,.15));
  border:2px solid rgba(251,191,36,.4);border-radius:20px;padding:16px 20px;
  position:relative;overflow:hidden;
  box-shadow:0 8px 24px rgba(251,191,36,.25),0 0 0 1px rgba(251,191,36,.1) inset;
  animation:pointsGlow 3s ease-in-out infinite;}
@keyframes pointsGlow{0%,100%{box-shadow:0 8px 24px rgba(251,191,36,.25),0 0 0 1px rgba(251,191,36,.1) inset;}
  50%{box-shadow:0 12px 32px rgba(251,191,36,.4),0 0 0 1px rgba(251,191,36,.2) inset;}}
.points-header-card::before{content:'';position:absolute;top:-30px;right:-30px;width:140px;height:140px;
  background:radial-gradient(circle,rgba(251,191,36,.15) 0%,transparent 70%);
  animation:pointsOrb 4s ease-in-out infinite;}
@keyframes pointsOrb{0%,100%{opacity:.4;transform:scale(1);}50%{opacity:.8;transform:scale(1.2);}}
.points-header-content{display:flex;justify-content:space-between;align-items:center;position:relative;z-index:1;}
.points-left{}
.points-label{font-size:10px;color:rgba(251,191,36,.8);letter-spacing:.8px;text-transform:uppercase;margin-bottom:4px;font-weight:600;}
.points-amount{font-family:'Fraunces',serif;font-size:42px;font-weight:800;
  background:linear-gradient(135deg,#fbbf24,#f59e0b,#fbbf24);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  line-height:1;display:flex;align-items:baseline;gap:4px;
  filter:drop-shadow(0 0 12px rgba(251,191,36,.4));}
.points-amount .label{font-size:16px;color:var(--gold);font-weight:600;}
.points-streak{background:rgba(0,0,0,.3);border-radius:12px;padding:8px 12px;text-align:center;}
.points-streak-value{font-size:18px;font-weight:700;color:var(--gold);display:block;}
.points-streak-label{font-size:9px;color:rgba(251,191,36,.7);text-transform:uppercase;letter-spacing:.5px;}

/* ‚îÄ‚îÄ Carbon Impact Card ‚îÄ‚îÄ */
.impact-card{margin:20px 20px 0;
  background:linear-gradient(145deg,#0d2016 0%,#0a1c12 50%,#0f2719 100%);
  border:1px solid rgba(74,222,128,.17);border-radius:28px;padding:24px 26px;
  position:relative;overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,.55),0 0 0 1px rgba(74,222,128,.05) inset;}
.impact-card::before{content:'';position:absolute;top:-60px;right:-60px;width:200px;height:200px;
  background:radial-gradient(circle,rgba(34,197,94,.11) 0%,transparent 70%);
  animation:cardGlow 4s ease-in-out infinite;}
@keyframes cardGlow{0%,100%{opacity:.6;transform:scale(1);}50%{opacity:1;transform:scale(1.3);}}

.impact-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px;}
.impact-left{}
.impact-label{font-size:11px;color:var(--text-muted);letter-spacing:.8px;text-transform:uppercase;margin-bottom:8px;}
.carbon-amount{font-family:'Fraunces',serif;font-size:48px;font-weight:700;
  background:linear-gradient(135deg,#f87171,#fb923c);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  line-height:1;display:flex;align-items:baseline;gap:4px;}
.carbon-amount .unit{font-size:20px;color:var(--text-muted);}

.goal-ring{width:68px;height:68px;position:relative;}
.goal-ring svg{transform:rotate(-90deg);}
.goal-ring-label{position:absolute;inset:0;display:flex;flex-direction:column;
  align-items:center;justify-content:center;font-size:13px;font-weight:700;
  color:var(--leaf-light);line-height:1;}
.goal-ring-label small{font-size:9px;color:var(--text-muted);font-weight:400;}

.goal-info{background:rgba(251,146,60,.08);border:1px solid rgba(251,146,60,.2);
  border-radius:16px;padding:12px 16px;display:flex;align-items:center;gap:12px;}
.goal-icon{font-size:24px;filter:drop-shadow(0 0 8px rgba(251,146,60,.4));}
.goal-text{flex:1;}
.goal-text .main{font-size:14px;font-weight:600;color:var(--text-pri);margin-bottom:2px;}
.goal-text .sub{font-size:11px;color:var(--text-muted);}

/* ‚îÄ‚îÄ Rewards Section ‚îÄ‚îÄ */
.rewards-section{margin:20px 20px 0;}
.section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding:0 4px;}
.section-title{font-size:15px;font-weight:700;color:var(--text-pri);}
.view-all-btn{font-size:12px;color:var(--leaf-light);font-weight:600;cursor:pointer;
  display:flex;align-items:center;gap:4px;transition:transform .2s;}
.view-all-btn:hover{transform:translateX(2px);}

.rewards-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.reward-card{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;
  padding:16px;position:relative;overflow:hidden;cursor:pointer;
  transition:all .3s cubic-bezier(.4,0,.2,1);}
.reward-card:hover{transform:translateY(-4px);border-color:rgba(74,222,128,.3);
  box-shadow:0 8px 24px rgba(0,0,0,.4);}
.reward-card.locked{opacity:.6;}
.reward-card.locked::after{content:'üîí';position:absolute;top:12px;right:12px;font-size:16px;opacity:.5;}
.reward-icon{font-size:32px;margin-bottom:8px;display:block;filter:drop-shadow(0 0 8px rgba(74,222,128,.3));}
.reward-title{font-size:13px;font-weight:600;color:var(--text-pri);margin-bottom:4px;}
.reward-desc{font-size:10px;color:var(--text-muted);margin-bottom:8px;line-height:1.4;}
.reward-cost{display:inline-flex;align-items:center;gap:4px;background:rgba(251,191,36,.12);
  border:1px solid rgba(251,191,36,.25);border-radius:8px;padding:4px 8px;font-size:11px;
  font-weight:700;color:var(--gold);}

/* ‚îÄ‚îÄ Level Progress ‚îÄ‚îÄ */
.level-card{margin:20px 20px 0;background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r);padding:18px 20px;}
.level-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}
.level-info{}
.level-badge{background:linear-gradient(135deg,rgba(74,222,128,.2),rgba(34,197,94,.15));
  border:1px solid rgba(74,222,128,.3);border-radius:10px;padding:6px 12px;
  font-size:12px;font-weight:700;color:var(--leaf-light);display:inline-flex;
  align-items:center;gap:6px;}
.level-title{font-size:11px;color:var(--text-muted);margin-top:4px;}
.next-reward{text-align:right;font-size:11px;color:var(--text-muted);}
.next-reward-value{font-size:14px;font-weight:700;color:var(--leaf-light);display:block;}
.level-progress-bar{height:10px;background:rgba(255,255,255,.05);border-radius:10px;overflow:hidden;margin-top:12px;}
.level-progress-fill{height:100%;background:linear-gradient(90deg,var(--green-mid),var(--leaf-light));
  border-radius:10px;transition:width .5s cubic-bezier(.4,0,.2,1);position:relative;}
.level-progress-fill::after{content:'';position:absolute;inset:0;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);
  animation:shimmer 2s infinite;}
@keyframes shimmer{0%{transform:translateX(-100%);}100%{transform:translateX(100%);}}

/* ‚îÄ‚îÄ Eco Merchants Page ‚îÄ‚îÄ */
.merchant-card{background:var(--bg-card);border:1px solid var(--border);border-radius:18px;
  padding:18px;margin-bottom:12px;position:relative;overflow:hidden;
  transition:all .3s cubic-bezier(.4,0,.2,1);}
.merchant-card:hover{transform:translateY(-2px);border-color:rgba(74,222,128,.3);
  box-shadow:0 8px 24px rgba(0,0,0,.4);}
.merchant-header{display:flex;gap:14px;margin-bottom:12px;}
.merchant-logo{width:56px;height:56px;background:linear-gradient(135deg,rgba(74,222,128,.15),rgba(34,197,94,.1));
  border:1px solid rgba(74,222,128,.2);border-radius:14px;display:flex;
  align-items:center;justify-content:center;font-size:28px;flex-shrink:0;}
.merchant-info{flex:1;}
.merchant-name{font-size:15px;font-weight:700;color:var(--text-pri);margin-bottom:4px;}
.merchant-category{font-size:10px;color:var(--text-muted);text-transform:uppercase;
  letter-spacing:.6px;margin-bottom:6px;}
.merchant-rating{display:flex;align-items:center;gap:6px;}
.stars{color:var(--gold);font-size:12px;}
.rating-count{font-size:10px;color:var(--text-muted);}
.merchant-offer{background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.2);
  border-radius:12px;padding:10px 12px;margin-bottom:12px;}
.offer-text{font-size:12px;font-weight:600;color:var(--text-pri);margin-bottom:2px;}
.offer-desc{font-size:10px;color:var(--text-muted);}
.merchant-actions{display:flex;gap:8px;}
.merchant-btn{flex:1;padding:10px;border-radius:10px;font-size:12px;font-weight:600;
  cursor:pointer;transition:all .2s;text-align:center;}
.merchant-btn.primary{background:rgba(74,222,128,.12);border:1px solid rgba(74,222,128,.3);
  color:var(--leaf-light);}
.merchant-btn.primary:hover{background:rgba(74,222,128,.18);transform:translateY(-1px);}
.merchant-btn.secondary{background:rgba(255,255,255,.03);border:1px solid var(--border);
  color:var(--text-muted);}
.merchant-btn.secondary:hover{border-color:rgba(74,222,128,.2);color:var(--text-pri);}

.merchant-stats{display:flex;gap:12px;padding:12px;background:rgba(255,255,255,.02);
  border-radius:12px;margin-top:12px;}
.merchant-stat{flex:1;text-align:center;}
.merchant-stat-value{font-size:16px;font-weight:700;color:var(--leaf-light);display:block;}
.merchant-stat-label{font-size:9px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px;}

/* ‚îÄ‚îÄ Investment Offers ‚îÄ‚îÄ */
.investment-card{background:linear-gradient(145deg,rgba(74,222,128,.08),rgba(34,197,94,.05));
  border:1px solid rgba(74,222,128,.2);border-radius:18px;padding:20px;
  margin-bottom:14px;position:relative;overflow:hidden;}
.investment-card::before{content:'';position:absolute;top:-40px;right:-40px;width:120px;height:120px;
  background:radial-gradient(circle,rgba(74,222,128,.1) 0%,transparent 70%);}
.investment-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:14px;}
.investment-title{font-size:16px;font-weight:700;color:var(--text-pri);margin-bottom:4px;}
.investment-subtitle{font-size:11px;color:var(--text-muted);}
.investment-badge{background:rgba(251,191,36,.15);border:1px solid rgba(251,191,36,.3);
  border-radius:10px;padding:6px 10px;font-size:11px;font-weight:700;color:var(--gold);
  white-space:nowrap;}
.investment-details{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px;}
.investment-detail{background:rgba(0,0,0,.2);border-radius:10px;padding:10px;text-align:center;}
.investment-detail-label{font-size:9px;color:var(--text-muted);text-transform:uppercase;
  letter-spacing:.5px;margin-bottom:4px;}
.investment-detail-value{font-size:15px;font-weight:700;color:var(--leaf-light);}
.investment-cta{background:rgba(74,222,128,.15);border:1px solid rgba(74,222,128,.35);
  border-radius:12px;padding:12px;text-align:center;cursor:pointer;
  transition:all .2s;}
.investment-cta:hover{background:rgba(74,222,128,.22);transform:translateY(-2px);}
.investment-cta-text{font-size:13px;font-weight:700;color:var(--leaf-light);}

/* ‚îÄ‚îÄ Points Animation ‚îÄ‚îÄ */
@keyframes pointsEarned{
  0%{transform:translateY(0) scale(1);opacity:1;}
  100%{transform:translateY(-100px) scale(1.5);opacity:0;}
}
.points-floating{position:fixed;font-size:24px;font-weight:800;color:var(--gold);
  pointer-events:none;z-index:9999;
  animation:pointsEarned 1.5s cubic-bezier(.4,0,.2,1) forwards;
  filter:drop-shadow(0 0 12px rgba(251,191,36,.6));}

/* ‚îÄ‚îÄ Toast Notification ‚îÄ‚îÄ */
.toast-container{position:fixed;top:20px;left:50%;transform:translateX(-50%);
  z-index:10000;max-width:380px;width:90%;pointer-events:none;}
.toast{background:linear-gradient(135deg,rgba(74,222,128,.95),rgba(34,197,94,.92));
  backdrop-filter:blur(20px);border:2px solid rgba(134,239,172,.4);
  border-radius:16px;padding:16px 20px;margin-bottom:10px;
  box-shadow:0 8px 32px rgba(0,0,0,.4),0 0 0 1px rgba(74,222,128,.2) inset;
  transform:translateY(-120%);opacity:0;pointer-events:all;
  transition:all .4s cubic-bezier(.4,0,.2,1);}
.toast.show{transform:translateY(0);opacity:1;}
.toast.hide{transform:translateY(-120%);opacity:0;}
.toast-content{display:flex;align-items:center;gap:12px;}
.toast-icon{font-size:28px;flex-shrink:0;
  filter:drop-shadow(0 0 8px rgba(255,255,255,.3));}
.toast-text{flex:1;min-width:0;}
.toast-title{font-size:15px;font-weight:700;color:#fff;margin-bottom:2px;
  text-shadow:0 1px 2px rgba(0,0,0,.3);}
.toast-message{font-size:12px;color:rgba(255,255,255,.9);line-height:1.4;
  text-shadow:0 1px 2px rgba(0,0,0,.2);}
@keyframes toastPulse{
  0%,100%{box-shadow:0 8px 32px rgba(0,0,0,.4),0 0 0 1px rgba(74,222,128,.2) inset;}
  50%{box-shadow:0 12px 40px rgba(0,0,0,.5),0 0 0 2px rgba(134,239,172,.6) inset;}
}
.toast.show{animation:toastPulse 2s ease-in-out;}

/* ‚îÄ‚îÄ New Transaction Highlight ‚îÄ‚îÄ */
@keyframes newTxnHighlight{
  0%{background:rgba(74,222,128,.15);transform:translateX(-5px);}
  50%{background:rgba(74,222,128,.08);}
  100%{background:transparent;transform:translateX(0);}
}
.txn-item.new-txn{
  animation:newTxnHighlight 1.2s ease-out;
}

/* ‚îÄ‚îÄ Bottom Nav ‚îÄ‚îÄ */
.bottom-nav{display:flex;background:var(--bg-glass);backdrop-filter:blur(20px);
  border-top:1px solid var(--border);padding:8px 12px 12px;position:relative;z-index:10;}
.nav-item{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;
  padding:8px 4px;cursor:pointer;position:relative;transition:all .25s;}
.nav-item.active{color:var(--leaf-light);}
.nav-icon{font-size:22px;transition:transform .2s;}
.nav-item.active .nav-icon{transform:scale(1.15);}
.nav-label{font-size:10px;font-weight:600;letter-spacing:.3px;}
.nav-item.active .nav-label{color:var(--leaf-light);}

/* ‚îÄ‚îÄ Sections ‚îÄ‚îÄ */
.section{margin:20px 20px 0;}
.section-title{font-size:14px;font-weight:700;color:var(--text-pri);margin-bottom:12px;padding:0 4px;}

/* ‚îÄ‚îÄ Transaction Items ‚îÄ‚îÄ */
.txn-list{display:flex;flex-direction:column;gap:10px;}
.txn-item{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;
  padding:14px 16px;display:flex;align-items:center;gap:12px;
  transition:all .2s;}
.txn-icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;
  justify-content:center;font-size:22px;flex-shrink:0;}
.txn-icon.low{background:rgba(74,222,128,.1);border:1px solid rgba(74,222,128,.2);}
.txn-icon.medium{background:rgba(251,191,36,.1);border:1px solid rgba(251,191,36,.2);}
.txn-icon.high{background:rgba(248,113,113,.1);border:1px solid rgba(248,113,113,.2);}
.txn-info{flex:1;min-width:0;}
.txn-name{font-size:14px;font-weight:600;color:var(--text-pri);margin-bottom:3px;}
.txn-desc{font-size:11px;color:var(--text-muted);}
.txn-right{text-align:right;display:flex;flex-direction:column;align-items:flex-end;gap:4px;}
.txn-carbon{font-size:13px;font-weight:700;}
.txn-carbon.low{color:var(--leaf-light);}
.txn-carbon.medium{color:var(--gold);}
.txn-carbon.high{color:var(--red);}
.txn-points{font-size:10px;font-weight:600;color:var(--gold);
  background:rgba(251,191,36,.1);border-radius:6px;padding:2px 6px;}

/* ‚îÄ‚îÄ Filter Tabs ‚îÄ‚îÄ */
.filter-tabs{display:flex;gap:8px;margin-bottom:16px;overflow-x:auto;padding:0 4px;
  -webkit-overflow-scrolling:touch;scrollbar-width:none;}
.filter-tabs::-webkit-scrollbar{display:none;}
.filter-tab{background:rgba(255,255,255,.03);border:1px solid var(--border);
  border-radius:12px;padding:8px 16px;font-size:12px;font-weight:600;
  color:var(--text-muted);cursor:pointer;white-space:nowrap;transition:all .2s;}
.filter-tab.active{background:rgba(74,222,128,.12);border-color:rgba(74,222,128,.3);
  color:var(--leaf-light);}
.filter-tab:hover{border-color:rgba(74,222,128,.2);}

/* ‚îÄ‚îÄ Weekly Stats ‚îÄ‚îÄ */
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;}
.stat-card{background:var(--bg-card);border:1px solid var(--border);border-radius:14px;
  padding:14px;text-align:center;}
.stat-value{font-size:24px;font-weight:700;display:block;margin-bottom:4px;}
.stat-value.green{color:var(--leaf-light);}
.stat-value.orange{color:var(--orange);}
.stat-value.gold{color:var(--gold);}
.stat-label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px;}

.weekly-breakdown{background:var(--bg-card);border:1px solid var(--border);
  border-radius:16px;padding:18px;}
.breakdown-item{display:flex;justify-content:space-between;align-items:center;
  padding:10px 0;border-bottom:1px solid rgba(255,255,255,.03);}
.breakdown-item:last-child{border-bottom:none;}
.breakdown-label{font-size:13px;color:var(--text-pri);font-weight:500;}
.breakdown-value{font-size:13px;font-weight:700;}
.progress-bar{height:6px;background:rgba(255,255,255,.05);border-radius:6px;margin-top:6px;overflow:hidden;}
.progress-fill{height:100%;border-radius:6px;transition:width .5s cubic-bezier(.4,0,.2,1);}
.progress-fill.green{background:var(--leaf-light);}
.progress-fill.orange{background:var(--orange);}

.weekly-badge{display:inline-block;font-size:11px;font-weight:600;padding:4px 10px;
  border-radius:8px;margin-top:4px;}

/* ‚îÄ‚îÄ Profile ‚îÄ‚îÄ */
.profile-header{padding:24px 20px;text-align:center;position:relative;}
.profile-avatar{width:80px;height:80px;border-radius:50%;margin:0 auto 12px;
  background:linear-gradient(135deg,#16a34a,#4ade80);
  display:flex;align-items:center;justify-content:center;font-size:36px;
  border:3px solid rgba(74,222,128,.3);
  box-shadow:0 0 24px rgba(74,222,128,.4);}
.profile-name{font-family:'Fraunces',serif;font-size:22px;font-weight:700;
  color:var(--text-pri);margin-bottom:4px;}
.profile-email{font-size:12px;color:var(--text-muted);margin-bottom:12px;}
.profile-stats{display:flex;gap:16px;justify-content:center;}
.profile-stat{text-align:center;}
.profile-stat-value{font-size:20px;font-weight:700;color:var(--leaf-light);display:block;}
.profile-stat-label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px;}

.profile-actions{display:flex;gap:8px;padding:0 20px;margin-bottom:20px;}
.profile-btn{flex:1;background:rgba(74,222,128,.1);border:1px solid rgba(74,222,128,.25);
  border-radius:12px;padding:10px;font-size:12px;font-weight:600;color:var(--leaf-light);
  cursor:pointer;transition:all .2s;text-align:center;}
.profile-btn:hover{background:rgba(74,222,128,.15);transform:translateY(-1px);}

.menu-section{padding:0 20px;}
.menu-item{background:var(--bg-card);border:1px solid var(--border);border-radius:14px;
  padding:14px 16px;margin-bottom:10px;display:flex;align-items:center;gap:12px;
  cursor:pointer;transition:all .2s;}
.menu-item:hover{border-color:rgba(74,222,128,.25);transform:translateX(2px);}
.menu-icon{font-size:20px;width:36px;height:36px;background:rgba(74,222,128,.08);
  border-radius:10px;display:flex;align-items:center;justify-content:center;}
.menu-text{flex:1;}
.menu-title{font-size:14px;font-weight:600;color:var(--text-pri);margin-bottom:2px;}
.menu-subtitle{font-size:11px;color:var(--text-muted);}
.menu-arrow{color:var(--text-muted);font-size:18px;}

.logout-btn{background:rgba(248,113,113,.1);border:1px solid rgba(248,113,113,.25);
  border-radius:12px;padding:12px;margin:20px 20px;font-size:13px;font-weight:600;
  color:var(--red);cursor:pointer;text-align:center;transition:all .2s;}
.logout-btn:hover{background:rgba(248,113,113,.15);transform:translateY(-1px);}

/* ‚îÄ‚îÄ Modal ‚îÄ‚îÄ */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(8px);
  z-index:1000;display:flex;align-items:flex-end;opacity:0;pointer-events:none;
  transition:opacity .3s cubic-bezier(.4,0,.2,1);}
.modal.open{opacity:1;pointer-events:all;}
.modal-content{background:var(--bg-card);border:1px solid var(--border);
  border-radius:28px 28px 0 0;width:100%;max-width:430px;margin:0 auto;
  padding:24px 24px 32px;transform:translateY(100%);
  transition:transform .4s cubic-bezier(.4,0,.2,1);}
.modal.open .modal-content{transform:translateY(0);}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
.modal-title{font-size:18px;font-weight:700;color:var(--text-pri);}
.modal-close{width:32px;height:32px;border-radius:50%;background:rgba(255,255,255,.05);
  display:flex;align-items:center;justify-content:center;cursor:pointer;
  font-size:20px;color:var(--text-muted);transition:all .2s;}
.modal-close:hover{background:rgba(255,255,255,.1);transform:rotate(90deg);}
.modal-body{margin-bottom:20px;}
.modal-actions{display:flex;gap:10px;}
.modal-btn{flex:1;padding:14px;border-radius:12px;font-size:14px;font-weight:600;
  cursor:pointer;transition:all .2s;text-align:center;}
.modal-btn.primary{background:rgba(74,222,128,.15);border:1px solid rgba(74,222,128,.35);
  color:var(--leaf-light);}
.modal-btn.primary:hover{background:rgba(74,222,128,.22);transform:translateY(-2px);}
.modal-btn.secondary{background:rgba(255,255,255,.03);border:1px solid var(--border);
  color:var(--text-muted);}
.modal-btn.secondary:hover{border-color:rgba(74,222,128,.2);}

/* ‚îÄ‚îÄ Goal Input ‚îÄ‚îÄ */
.goal-input{width:100%;background:rgba(255,255,255,.03);border:1px solid var(--border);
  border-radius:12px;padding:14px 16px;font-size:18px;font-weight:600;color:var(--text-pri);
  font-family:'Fraunces',serif;text-align:center;transition:all .2s;}
.goal-input:focus{outline:none;border-color:rgba(74,222,128,.4);background:rgba(74,222,128,.05);}
.goal-suggestions{display:flex;gap:8px;margin-top:12px;}
.goal-suggest-btn{flex:1;background:rgba(255,255,255,.03);border:1px solid var(--border);
  border-radius:10px;padding:10px 8px;font-size:12px;font-weight:600;color:var(--text-muted);
  cursor:pointer;transition:all .2s;white-space:nowrap;}
.goal-suggest-btn:hover{border-color:rgba(74,222,128,.3);color:var(--leaf-light);
  background:rgba(74,222,128,.08);}

/* ‚îÄ‚îÄ Goal Status Alert ‚îÄ‚îÄ */
.goal-status-alert{margin:16px 20px 0;border-radius:var(--r);padding:16px 18px;
  display:flex;align-items:center;transition:all .4s cubic-bezier(.4,0,.2,1);
  transform-origin:top;opacity:1;max-height:100px;}
.goal-status-alert.hidden{opacity:0;max-height:0;padding:0;margin:0;overflow:hidden;}
.goal-status-alert.success{background:linear-gradient(135deg,rgba(74,222,128,.15),rgba(34,197,94,.1));
  border:1px solid rgba(74,222,128,.3);}
.goal-status-alert.failed{background:linear-gradient(135deg,rgba(248,113,113,.15),rgba(251,146,60,.1));
  border:1px solid rgba(248,113,113,.3);}
.goal-status-content{display:flex;align-items:center;gap:12px;width:100%;}
.goal-status-icon{font-size:32px;flex-shrink:0;}
.goal-status-text{flex:1;}
.goal-status-title{font-size:15px;font-weight:700;color:var(--text-pri);margin-bottom:3px;}
.goal-status-message{font-size:12px;color:var(--text-muted);}

/* ‚îÄ‚îÄ Scroll padding ‚îÄ‚îÄ */
.page{padding-bottom:90px;}

/* ‚îÄ‚îÄ Utilities ‚îÄ‚îÄ */
.mb-12{margin-bottom:12px;}
.mt-8{margin-top:8px;}

/* ‚îÄ‚îÄ Detail Modal ‚îÄ‚îÄ */
.detail-modal{position:fixed;inset:0;background:rgba(0,0,0,.9);backdrop-filter:blur(10px);
  z-index:2000;display:flex;align-items:center;justify-content:center;padding:20px;
  opacity:0;pointer-events:none;transition:opacity .3s cubic-bezier(.4,0,.2,1);}
.detail-modal.open{opacity:1;pointer-events:all;}
.detail-modal-content{background:var(--bg-card);border:1px solid var(--border);
  border-radius:24px;width:100%;max-width:400px;max-height:80vh;overflow-y:auto;
  padding:24px;transform:scale(.9);transition:transform .3s cubic-bezier(.4,0,.2,1);}
.detail-modal.open .detail-modal-content{transform:scale(1);}
.detail-modal-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px;}
.detail-modal-icon{font-size:48px;margin-bottom:12px;}
.detail-modal-title{font-size:20px;font-weight:700;color:var(--text-pri);margin-bottom:6px;}
.detail-modal-subtitle{font-size:13px;color:var(--text-muted);margin-bottom:16px;}
.detail-modal-close{width:32px;height:32px;border-radius:50%;background:rgba(255,255,255,.05);
  display:flex;align-items:center;justify-content:center;cursor:pointer;
  font-size:20px;color:var(--text-muted);transition:all .2s;flex-shrink:0;}
.detail-modal-close:hover{background:rgba(255,255,255,.1);transform:rotate(90deg);}
.detail-section{margin-bottom:20px;}
.detail-section-title{font-size:12px;color:var(--text-muted);text-transform:uppercase;
  letter-spacing:.8px;margin-bottom:10px;font-weight:600;}
.detail-section-content{font-size:14px;color:var(--text-pri);line-height:1.6;}
.detail-feature-list{display:flex;flex-direction:column;gap:8px;}
.detail-feature{display:flex;align-items:flex-start;gap:8px;padding:8px;
  background:rgba(74,222,128,.05);border-radius:10px;}
.detail-feature-icon{flex-shrink:0;font-size:18px;}
.detail-feature-text{font-size:13px;color:var(--text-pri);}
.detail-stats{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;}
.detail-stat{background:rgba(255,255,255,.03);border-radius:12px;padding:12px;text-align:center;}
.detail-stat-value{font-size:20px;font-weight:700;color:var(--leaf-light);display:block;margin-bottom:4px;}
.detail-stat-label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px;}
.detail-actions{display:flex;gap:10px;}
.detail-btn{flex:1;padding:14px;border-radius:12px;font-size:14px;font-weight:600;
  cursor:pointer;transition:all .2s;text-align:center;}
.detail-btn.primary{background:rgba(74,222,128,.15);border:1px solid rgba(74,222,128,.35);
  color:var(--leaf-light);}
.detail-btn.primary:hover{background:rgba(74,222,128,.22);transform:translateY(-2px);}
.detail-btn.primary.disabled{opacity:.4;cursor:not-allowed;}
.detail-btn.primary.disabled:hover{transform:none;}
.detail-btn.secondary{background:rgba(255,255,255,.03);border:1px solid var(--border);
  color:var(--text-muted);}
.detail-btn.secondary:hover{border-color:rgba(74,222,128,.2);}
.claimed-badge{background:rgba(251,191,36,.15);border:1px solid rgba(251,191,36,.3);
  border-radius:12px;padding:10px 16px;text-align:center;margin-bottom:16px;}
.claimed-badge-text{font-size:13px;font-weight:600;color:var(--gold);}

/* ‚îÄ‚îÄ Carbon Chart ‚îÄ‚îÄ */
.carbon-chart-container{background:var(--bg-card);border:1px solid var(--border);
  border-radius:18px;padding:20px;margin-bottom:16px;}
.chart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
.chart-title{font-size:14px;font-weight:700;color:var(--text-pri);}
.chart-legend{display:flex;gap:12px;flex-wrap:wrap;}
.legend-item{display:flex;align-items:center;gap:6px;font-size:11px;color:var(--text-muted);}
.legend-dot{width:8px;height:8px;border-radius:50%;}
.chart-canvas-wrapper{position:relative;height:220px;margin-bottom:12px;}
.chart-canvas{width:100%;height:100%;}
.day-labels{display:flex;justify-content:space-between;padding:0 10px;}
.day-label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px;}
</style>
</head>
<body>

<!-- Toast Notification Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Carbon particles -->
<div class="carbon-field" id="carbonField"></div>

<div class="app">
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- PAGES -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="pages">
    
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <!-- HOME PAGE -->
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="page active" id="homePage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">üå±</div>
          CarbonCash
        </div>
        <div class="qr-btn" id="qrBtn">üì∑</div>
      </div>

      <div class="greeting">
        <div class="sub">Good morning,</div>
        <div class="name">Eco Warrior</div>
      </div>

      <!-- Green Points Header -->
      <div class="points-header-card">
        <div class="points-header-content">
          <div class="points-left">
            <div class="points-label">Green Points</div>
            <div class="points-amount">
              <span id="greenPoints">0</span>
              <span class="label">GP</span>
            </div>
          </div>
          <div class="points-streak">
            <span class="points-streak-value" id="streakDays">0</span>
            <span class="points-streak-label">Day Streak</span>
          </div>
        </div>
      </div>

      <!-- Carbon Impact Card -->
      <div class="impact-card">
        <div class="impact-header">
          <div class="impact-left">
            <div class="impact-label">This Week</div>
            <div class="carbon-amount">
              <span id="weekCarbon">0.0</span>
              <span class="unit">kg</span>
            </div>
          </div>
          <div class="goal-ring">
            <svg width="68" height="68">
              <circle cx="34" cy="34" r="30" stroke="rgba(255,255,255,.05)" stroke-width="6" fill="none"/>
              <circle id="goalCircle" cx="34" cy="34" r="30" stroke="url(#goalGrad)" stroke-width="6" fill="none"
                stroke-dasharray="188.5" stroke-dashoffset="188.5" stroke-linecap="round"/>
              <defs>
                <linearGradient id="goalGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#22c55e"/>
                  <stop offset="100%" style="stop-color:#4ade80"/>
                </linearGradient>
              </defs>
            </svg>
            <div class="goal-ring-label">
              <span>0%</span>
              <small>of goal</small>
            </div>
          </div>
        </div>
        <div class="goal-info">
          <div class="goal-icon">üéØ</div>
          <div class="goal-text">
            <div class="main">10.0 kg away from your Green Goal</div>
            <div class="sub">Stay under to earn 50 GP!</div>
          </div>
        </div>
      </div>

      <!-- Goal Status Alert -->
      <div class="goal-status-alert hidden success" id="goalStatusAlert">
        <div class="goal-status-content">
          <div class="goal-status-icon" id="goalStatusIcon">üéâ</div>
          <div class="goal-status-text">
            <div class="goal-status-title" id="goalStatusTitle">Goal Achieved!</div>
            <div class="goal-status-message" id="goalStatusMessage">You earned 50 Green Points!</div>
          </div>
        </div>
      </div>

      <!-- Level Progress -->
      <div class="level-card">
        <div class="level-header">
          <div class="level-info">
            <div class="level-badge">
              <span>üåü</span>
              <span>Level <span id="userLevel">1</span></span>
            </div>
            <div class="level-title">Eco Beginner</div>
          </div>
          <div class="next-reward">
            <span class="next-reward-value" id="pointsToNext">250 GP</span>
            <span>to Level 2</span>
          </div>
        </div>
        <div class="level-progress-bar">
          <div class="level-progress-fill" id="levelProgressFill" style="width:0%"></div>
        </div>
      </div>

      <!-- Rewards -->
      <div class="rewards-section">
        <div class="section-header">
          <div class="section-title">üéÅ Available Rewards</div>
          <div class="view-all-btn" onclick="navigateTo('rewards')">View All ‚Üí</div>
        </div>
        <div class="rewards-grid">
          <div class="reward-card" onclick="showRewardDetail('solar', 100)">
            <span class="reward-icon">‚òÄÔ∏è</span>
            <div class="reward-title">Solar Investment</div>
            <div class="reward-desc">10% discount on solar panels</div>
            <span class="reward-cost">üí∞ 100 GP</span>
          </div>
          <div class="reward-card" onclick="showRewardDetail('ev', 150)">
            <span class="reward-icon">‚ö°</span>
            <div class="reward-title">EV Charging</div>
            <div class="reward-desc">Free charging for 1 month</div>
            <span class="reward-cost">üí∞ 150 GP</span>
          </div>
          <div class="reward-card locked" onclick="showRewardDetail('wind', 300)">
            <span class="reward-icon">üåä</span>
            <div class="reward-title">Wind Energy</div>
            <div class="reward-desc">15% off wind energy plan</div>
            <span class="reward-cost">üí∞ 300 GP</span>
          </div>
          <div class="reward-card locked" onclick="showRewardDetail('tree', 500)">
            <span class="reward-icon">üå≥</span>
            <div class="reward-title">Tree Planting</div>
            <div class="reward-desc">Plant 10 trees in your name</div>
            <span class="reward-cost">üí∞ 500 GP</span>
          </div>
        </div>
      </div>

      <!-- Recent Transactions -->
      <div class="section">
        <div class="section-title">Recent Activity</div>
        <div class="txn-list" id="homeTxnList">
          <!-- Transactions populated by JS -->
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <!-- TRANSACTIONS PAGE -->
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="page" id="transactionsPage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">üìä</div>
          Transactions
        </div>
      </div>

      <div class="section">
        <div class="filter-tabs">
          <div class="filter-tab active" data-filter="all">All</div>
          <div class="filter-tab" data-filter="low">Low Impact</div>
          <div class="filter-tab" data-filter="medium">Medium</div>
          <div class="filter-tab" data-filter="high">High Impact</div>
        </div>

        <div class="txn-list" id="transactionsTxnList">
          <!-- Transactions populated by JS -->
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <!-- ECO MERCHANTS PAGE -->
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="page" id="merchantsPage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">üè™</div>
          Eco Merchants
        </div>
      </div>

      <div class="greeting">
        <div class="sub">Discover sustainable partners</div>
        <div class="name" style="font-size:22px;">Earn rewards for green purchases</div>
      </div>

      <div class="section">
        <div class="section-title">Featured Merchants</div>
        
        <!-- Merchant 1 -->
        <div class="merchant-card" onclick="showMerchantDetail('solar')">
          <div class="merchant-header">
            <div class="merchant-logo">‚òÄÔ∏è</div>
            <div class="merchant-info">
              <div class="merchant-name">SolarPro Solutions</div>
              <div class="merchant-category">Renewable Energy</div>
              <div class="merchant-rating">
                <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                <span class="rating-count">(2.4k)</span>
              </div>
            </div>
          </div>
          <div class="merchant-offer">
            <div class="offer-text">üéÅ Earn 30 GP per $100 spent</div>
            <div class="offer-desc">Plus 15% discount with 200+ GP</div>
          </div>
          <div class="merchant-stats">
            <div class="merchant-stat">
              <span class="merchant-stat-value">30</span>
              <span class="merchant-stat-label">GP/Purchase</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">15%</span>
              <span class="merchant-stat-label">Max Discount</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">4.8k</span>
              <span class="merchant-stat-label">Users</span>
            </div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('solar')">Visit Store</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('solar')">üíö Save</div>
          </div>
        </div>

        <!-- Merchant 2 -->
        <div class="merchant-card" onclick="showMerchantDetail('ev')">
          <div class="merchant-header">
            <div class="merchant-logo">‚ö°</div>
            <div class="merchant-info">
              <div class="merchant-name">EcoCharge Network</div>
              <div class="merchant-category">EV Charging</div>
              <div class="merchant-rating">
                <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                <span class="rating-count">(1.8k)</span>
              </div>
            </div>
          </div>
          <div class="merchant-offer">
            <div class="offer-text">üéÅ Earn 5 GP per charge session</div>
            <div class="offer-desc">Free charging with 150+ GP</div>
          </div>
          <div class="merchant-stats">
            <div class="merchant-stat">
              <span class="merchant-stat-value">5</span>
              <span class="merchant-stat-label">GP/Session</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">100%</span>
              <span class="merchant-stat-label">Free Charge</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">2.1k</span>
              <span class="merchant-stat-label">Stations</span>
            </div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('ev')">Find Station</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('ev')">üíö Save</div>
          </div>
        </div>

        <!-- Merchant 3 -->
        <div class="merchant-card" onclick="showMerchantDetail('grocer')">
          <div class="merchant-header">
            <div class="merchant-logo">üåø</div>
            <div class="merchant-info">
              <div class="merchant-name">GreenGrocer Market</div>
              <div class="merchant-category">Organic Food</div>
              <div class="merchant-rating">
                <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</span>
                <span class="rating-count">(3.2k)</span>
              </div>
            </div>
          </div>
          <div class="merchant-offer">
            <div class="offer-text">üéÅ Earn 2 GP per $10 spent</div>
            <div class="offer-desc">10% discount on organic produce with 100+ GP</div>
          </div>
          <div class="merchant-stats">
            <div class="merchant-stat">
              <span class="merchant-stat-value">20</span>
              <span class="merchant-stat-label">GP/Week Avg</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">10%</span>
              <span class="merchant-stat-label">Discount</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">45</span>
              <span class="merchant-stat-label">Locations</span>
            </div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('grocer')">Shop Now</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('grocer')">üíö Save</div>
          </div>
        </div>

        <!-- Merchant 4 -->
        <div class="merchant-card" onclick="showMerchantDetail('bike')">
          <div class="merchant-header">
            <div class="merchant-logo">üö¥</div>
            <div class="merchant-info">
              <div class="merchant-name">BikeShare City</div>
              <div class="merchant-category">Green Transport</div>
              <div class="merchant-rating">
                <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                <span class="rating-count">(5.1k)</span>
              </div>
            </div>
          </div>
          <div class="merchant-offer">
            <div class="offer-text">üéÅ Earn 3 GP per ride</div>
            <div class="offer-desc">Monthly pass discount with 80+ GP</div>
          </div>
          <div class="merchant-stats">
            <div class="merchant-stat">
              <span class="merchant-stat-value">3</span>
              <span class="merchant-stat-label">GP/Ride</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">20%</span>
              <span class="merchant-stat-label">Pass Discount</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">300+</span>
              <span class="merchant-stat-label">Stations</span>
            </div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('bike')">Find Bike</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('bike')">üíö Save</div>
          </div>
        </div>

        <!-- Merchant 5 -->
        <div class="merchant-card" onclick="showMerchantDetail('recycle')">
          <div class="merchant-header">
            <div class="merchant-logo">‚ôªÔ∏è</div>
            <div class="merchant-info">
              <div class="merchant-name">RecycleHub</div>
              <div class="merchant-category">Waste Management</div>
              <div class="merchant-rating">
                <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                <span class="rating-count">(4.3k)</span>
              </div>
            </div>
          </div>
          <div class="merchant-offer">
            <div class="offer-text">üéÅ Earn 10 GP per recycling drop-off</div>
            <div class="offer-desc">Bonus rewards for electronics recycling</div>
          </div>
          <div class="merchant-stats">
            <div class="merchant-stat">
              <span class="merchant-stat-value">10</span>
              <span class="merchant-stat-label">GP/Drop-off</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">50</span>
              <span class="merchant-stat-label">Bonus GP</span>
            </div>
            <div class="merchant-stat">
              <span class="merchant-stat-value">120</span>
              <span class="merchant-stat-label">Centers</span>
            </div>
          </div>
          <div class="merchant-actions">
            <div class="merchant-btn primary" onclick="event.stopPropagation(); visitMerchant('recycle')">Find Center</div>
            <div class="merchant-btn secondary" onclick="event.stopPropagation(); saveMerchant('recycle')">üíö Save</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <!-- REWARDS PAGE -->
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="page" id="rewardsPage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">üéÅ</div>
          Rewards
        </div>
      </div>

      <div class="greeting">
        <div class="sub">Your Green Points</div>
        <div class="name" style="font-size:32px;">
          <span id="rewardsGP">0</span> GP
        </div>
      </div>

      <div class="section">
        <div class="section-title">Green Investment Discounts</div>

        <!-- Investment Offer 1 -->
        <div class="investment-card" onclick="showInvestmentDetail('solar', 100)">
          <div class="investment-header">
            <div>
              <div class="investment-title">Solar Panel Installation</div>
              <div class="investment-subtitle">Clean energy for your home</div>
            </div>
            <div class="investment-badge">üî• Popular</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail">
              <div class="investment-detail-label">Cost</div>
              <div class="investment-detail-value">100 GP</div>
            </div>
            <div class="investment-detail">
              <div class="investment-detail-label">You Save</div>
              <div class="investment-detail-value">10%</div>
            </div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('solar', 100)">
            <div class="investment-cta-text">Redeem Discount ‚Üí</div>
          </div>
        </div>

        <!-- Investment Offer 2 -->
        <div class="investment-card" onclick="showInvestmentDetail('ev-charging', 150)">
          <div class="investment-header">
            <div>
              <div class="investment-title">EV Charging Station</div>
              <div class="investment-subtitle">Home charging solution</div>
            </div>
            <div class="investment-badge">‚ö° New</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail">
              <div class="investment-detail-label">Cost</div>
              <div class="investment-detail-value">150 GP</div>
            </div>
            <div class="investment-detail">
              <div class="investment-detail-label">You Save</div>
              <div class="investment-detail-value">15%</div>
            </div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('ev-charging', 150)">
            <div class="investment-cta-text">Redeem Discount ‚Üí</div>
          </div>
        </div>

        <!-- Investment Offer 3 -->
        <div class="investment-card" onclick="showInvestmentDetail('wind-energy', 200)">
          <div class="investment-header">
            <div>
              <div class="investment-title">Wind Energy Subscription</div>
              <div class="investment-subtitle">100% renewable electricity</div>
            </div>
            <div class="investment-badge">üíö Eco</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail">
              <div class="investment-detail-label">Cost</div>
              <div class="investment-detail-value">200 GP</div>
            </div>
            <div class="investment-detail">
              <div class="investment-detail-label">You Save</div>
              <div class="investment-detail-value">20%</div>
            </div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('wind-energy', 200)">
            <div class="investment-cta-text">Redeem Discount ‚Üí</div>
          </div>
        </div>

        <!-- Investment Offer 4 -->
        <div class="investment-card" onclick="showInvestmentDetail('green-bonds', 300)">
          <div class="investment-header">
            <div>
              <div class="investment-title">Green Bond Investment</div>
              <div class="investment-subtitle">Support eco projects</div>
            </div>
            <div class="investment-badge">üìà Premium</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail">
              <div class="investment-detail-label">Cost</div>
              <div class="investment-detail-value">300 GP</div>
            </div>
            <div class="investment-detail">
              <div class="investment-detail-label">Bonus APY</div>
              <div class="investment-detail-value">+2%</div>
            </div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('green-bonds', 300)">
            <div class="investment-cta-text">Redeem Bonus ‚Üí</div>
          </div>
        </div>

        <!-- Investment Offer 5 -->
        <div class="investment-card" onclick="showInvestmentDetail('carbon-offset', 80)">
          <div class="investment-header">
            <div>
              <div class="investment-title">Carbon Offset Credits</div>
              <div class="investment-subtitle">Neutralize your footprint</div>
            </div>
            <div class="investment-badge">üåç Impact</div>
          </div>
          <div class="investment-details">
            <div class="investment-detail">
              <div class="investment-detail-label">Cost</div>
              <div class="investment-detail-value">80 GP</div>
            </div>
            <div class="investment-detail">
              <div class="investment-detail-label">Credits</div>
              <div class="investment-detail-value">5 tons</div>
            </div>
          </div>
          <div class="investment-cta" onclick="event.stopPropagation(); showInvestmentDetail('carbon-offset', 80)">
            <div class="investment-cta-text">Purchase Credits ‚Üí</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Lifestyle Rewards</div>
        <div class="rewards-grid">
          <div class="reward-card" onclick="showRewardDetail('coffee', 25)">
            <span class="reward-icon">‚òï</span>
            <div class="reward-title">Coffee Voucher</div>
            <div class="reward-desc">$5 at eco-friendly caf√©s</div>
            <span class="reward-cost">üí∞ 25 GP</span>
          </div>
          <div class="reward-card" onclick="showRewardDetail('bike-rental', 40)">
            <span class="reward-icon">üö≤</span>
            <div class="reward-title">Bike Rental</div>
            <div class="reward-desc">1 week free rental</div>
            <span class="reward-cost">üí∞ 40 GP</span>
          </div>
          <div class="reward-card" onclick="showRewardDetail('transit', 120)">
            <span class="reward-icon">üöá</span>
            <div class="reward-title">Transit Pass</div>
            <div class="reward-desc">1 month unlimited rides</div>
            <span class="reward-cost">üí∞ 120 GP</span>
          </div>
          <div class="reward-card" onclick="showRewardDetail('organic', 60)">
            <span class="reward-icon">ü•ó</span>
            <div class="reward-title">Organic Box</div>
            <div class="reward-desc">Fresh organic produce</div>
            <span class="reward-cost">üí∞ 60 GP</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <!-- WEEKLY PAGE -->
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="page" id="weeklyPage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">üìÖ</div>
          Weekly Stats
        </div>
        <div class="qr-btn" id="setGoalBtn">‚öôÔ∏è</div>
      </div>

      <div class="section">
        <!-- Carbon Chart -->
        <div class="carbon-chart-container">
          <div class="chart-header">
            <div class="chart-title">Weekly Carbon Footprint</div>
            <div class="chart-legend">
              <div class="legend-item">
                <div class="legend-dot" style="background:var(--leaf-light);"></div>
                <span>Daily CO‚ÇÇ</span>
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background:var(--gold);"></div>
                <span>Goal</span>
              </div>
            </div>
          </div>
          <div class="chart-canvas-wrapper">
            <canvas id="carbonChart" class="chart-canvas"></canvas>
          </div>
          <div class="day-labels">
            <span class="day-label">Mon</span>
            <span class="day-label">Tue</span>
            <span class="day-label">Wed</span>
            <span class="day-label">Thu</span>
            <span class="day-label">Fri</span>
            <span class="day-label">Sat</span>
            <span class="day-label">Sun</span>
          </div>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-value green" id="weeklyRemaining">10.0</span>
            <div class="stat-label">Remaining</div>
          </div>
          <div class="stat-card">
            <span class="stat-value orange" id="weeklyUsed">0.0</span>
            <div class="stat-label">Used</div>
          </div>
          <div class="stat-card">
            <span class="stat-value gold" id="weeklyGoalDisplay">10.0</span>
            <div class="stat-label">Goal (kg CO‚ÇÇ)</div>
          </div>
          <div class="stat-card">
            <span id="weeklyBadge" class="weekly-badge" style="background:rgba(74,222,128,.1);color:#4ade80;border:1px solid rgba(74,222,128,.25);">On Track</span>
          </div>
        </div>

        <div class="weekly-breakdown">
          <div class="section-title mb-12">Carbon Breakdown</div>
          <div class="breakdown-item">
            <span class="breakdown-label">üöó Transport</span>
            <span class="breakdown-value" id="transportValue" style="color:var(--red);">0.0 kg</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill orange" id="transportBar" style="width:0%"></div>
          </div>
          <div class="breakdown-item mt-8">
            <span class="breakdown-label">üçî Food</span>
            <span class="breakdown-value" id="foodValue" style="color:var(--orange);">0.0 kg</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill orange" id="foodBar" style="width:0%"></div>
          </div>
          <div class="breakdown-item mt-8">
            <span class="breakdown-label">üõçÔ∏è Shopping</span>
            <span class="breakdown-value" id="shoppingValue" style="color:var(--leaf-light);">0.0 kg</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill green" id="shoppingBar" style="width:0%"></div>
          </div>
          <div class="breakdown-item mt-8">
            <span class="breakdown-label">üí° Energy</span>
            <span class="breakdown-value" id="energyValue" style="color:var(--blue);">0.0 kg</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill green" id="energyBar" style="width:0%"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <!-- PROFILE PAGE -->
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="page" id="profilePage">
      <div class="profile-header">
        <div class="profile-avatar">üå±</div>
        <div class="profile-name">Eco Warrior</div>
        <div class="profile-email"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2b4e48446b484a59494445484a5843054a5b5b">[email&#160;protected]</a></div>
        <div class="profile-stats">
          <div class="profile-stat">
            <span class="profile-stat-value" id="profileTotalCarbon">0.0</span>
            <span class="profile-stat-label">Total kg CO‚ÇÇ</span>
          </div>
          <div class="profile-stat">
            <span class="profile-stat-value" id="profileGP">0</span>
            <span class="profile-stat-label">Green Points</span>
          </div>
          <div class="profile-stat">
            <span class="profile-stat-value" id="profileLevel">1</span>
            <span class="profile-stat-label">Level</span>
          </div>
        </div>
      </div>

      <div class="profile-actions">
        <div class="profile-btn" id="editProfileBtn">‚úèÔ∏è Edit Profile</div>
        <div class="profile-btn">üéÅ My Rewards</div>
      </div>

      <div class="menu-section">
        <div class="menu-item">
          <div class="menu-icon">üìä</div>
          <div class="menu-text">
            <div class="menu-title">Carbon History</div>
            <div class="menu-subtitle">View your impact over time</div>
          </div>
          <div class="menu-arrow">‚Ä∫</div>
        </div>
        <div class="menu-item">
          <div class="menu-icon">üéØ</div>
          <div class="menu-text">
            <div class="menu-title">Goals & Achievements</div>
            <div class="menu-subtitle">Track your eco milestones</div>
          </div>
          <div class="menu-arrow">‚Ä∫</div>
        </div>
        <div class="menu-item">
          <div class="menu-icon">üíö</div>
          <div class="menu-text">
            <div class="menu-title">Saved Merchants</div>
            <div class="menu-subtitle">Your favorite eco partners</div>
          </div>
          <div class="menu-arrow">‚Ä∫</div>
        </div>
        <div class="menu-item">
          <div class="menu-icon">‚öôÔ∏è</div>
          <div class="menu-text">
            <div class="menu-title">Settings</div>
            <div class="menu-subtitle">Preferences & notifications</div>
          </div>
          <div class="menu-arrow">‚Ä∫</div>
        </div>
        <div class="menu-item">
          <div class="menu-icon">üí¨</div>
          <div class="menu-text">
            <div class="menu-title">Help & Support</div>
            <div class="menu-subtitle">Get assistance</div>
          </div>
          <div class="menu-arrow">‚Ä∫</div>
        </div>
      </div>

      <div class="logout-btn" id="logoutBtn">üö™ Log Out</div>
    </div>

  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- BOTTOM NAV -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="bottom-nav">
    <div class="nav-item active" data-page="homePage">
      <div class="nav-icon">üè†</div>
      <div class="nav-label">Home</div>
    </div>
    <div class="nav-item" data-page="transactionsPage">
      <div class="nav-icon">üìä</div>
      <div class="nav-label">Activity</div>
    </div>
    <div class="nav-item" data-page="merchantsPage">
      <div class="nav-icon">üè™</div>
      <div class="nav-label">Merchants</div>
    </div>
    <div class="nav-item" data-page="rewardsPage">
      <div class="nav-icon">üéÅ</div>
      <div class="nav-label">Rewards</div>
    </div>
    <div class="nav-item" data-page="weeklyPage">
      <div class="nav-icon">üìÖ</div>
      <div class="nav-label">Weekly</div>
    </div>
    <div class="nav-item" data-page="profilePage">
      <div class="nav-icon">üë§</div>
      <div class="nav-label">Profile</div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- DETAIL INFO MODAL -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="detail-modal" id="detailModal">
  <div class="detail-modal-content">
    <div class="detail-modal-header">
      <div style="flex:1;">
        <div class="detail-modal-icon" id="detailIcon">‚òÄÔ∏è</div>
        <div class="detail-modal-title" id="detailTitle">Title</div>
        <div class="detail-modal-subtitle" id="detailSubtitle">Subtitle</div>
      </div>
      <div class="detail-modal-close" onclick="closeDetailModal()">‚úï</div>
    </div>
    
    <div id="detailClaimedBadge" class="claimed-badge" style="display:none;">
      <div class="claimed-badge-text">‚úì Already Claimed</div>
    </div>
    
    <div id="detailStatsSection" class="detail-stats" style="display:none;">
      <!-- Stats populated by JS -->
    </div>
    
    <div class="detail-section">
      <div class="detail-section-title">Description</div>
      <div class="detail-section-content" id="detailDescription">
        Description content
      </div>
    </div>
    
    <div class="detail-section" id="detailFeaturesSection" style="display:none;">
      <div class="detail-section-title">Features & Benefits</div>
      <div class="detail-feature-list" id="detailFeatures">
        <!-- Features populated by JS -->
      </div>
    </div>
    
    <div class="detail-section" id="detailTermsSection" style="display:none;">
      <div class="detail-section-title">Terms & Conditions</div>
      <div class="detail-section-content" id="detailTerms">
        Terms content
      </div>
    </div>
    
    <div class="detail-actions" id="detailActions">
      <!-- Actions populated by JS -->
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- GOAL MODAL -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="modal" id="goalModal">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title">Set Weekly Goal</div>
      <div class="modal-close" onclick="closeGoalModal()">‚úï</div>
    </div>
    <div class="modal-body">
      <input type="number" class="goal-input" id="goalInput" placeholder="10.0" step="0.1" min="1" max="100">
      <div class="goal-suggestions">
        <div class="goal-suggest-btn" data-goal="5">5 kg</div>
        <div class="goal-suggest-btn" data-goal="10">10 kg</div>
        <div class="goal-suggest-btn" data-goal="15">15 kg</div>
        <div class="goal-suggest-btn" data-goal="20">20 kg</div>
      </div>
    </div>
    <div class="modal-actions">
      <div class="modal-btn secondary" id="goalCancelBtn">Cancel</div>
      <div class="modal-btn primary" id="goalSaveBtn">Save Goal</div>
    </div>
  </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let greenPoints = 0;
let userLevel = 1;
let streakDays = 0;
let weeklyGoal = 10.0;
let goalStatus = 'active'; // 'active', 'success', 'failed'
let transactionCount = 0;
let claimedRewards = new Set(); // Track claimed rewards

// Weekly carbon data (simulated - 7 days)
let weeklyCarbon = [1.2, 0.8, 1.5, 0.9, 1.1, 0.7, 0.0]; // Last value is today (empty initially)

const allTransactions = [
  {name:'Coffee at GreenBean',desc:'Local organic caf√©',carbon:0.2,impact:'low',category:'food',points:5,icon:'‚òï'},
  {name:'Bus to Downtown',desc:'Public transit',carbon:0.8,impact:'low',category:'transport',points:8,icon:'üöå'},
  {name:'Grocery Shopping',desc:'Organic produce',carbon:1.2,impact:'low',category:'shopping',points:12,icon:'üõí'},
  {name:'Home Energy',desc:'Solar-powered',carbon:0.5,impact:'low',category:'energy',points:5,icon:'üí°'},
  {name:'Bike Share Ride',desc:'30 min rental',carbon:0.0,impact:'low',category:'transport',points:10,icon:'üö¥'},
  {name:'Lunch at EcoBistro',desc:'Plant-based meal',carbon:0.3,impact:'low',category:'food',points:6,icon:'ü•ó'}
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TOAST NOTIFICATIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showToast(title, message, icon = '‚úì', duration = 3000) {
  const container = document.getElementById('toastContainer');
  
  // Create toast element
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.innerHTML = `
    <div class="toast-content">
      <div class="toast-icon">${icon}</div>
      <div class="toast-text">
        <div class="toast-title">${title}</div>
        <div class="toast-message">${message}</div>
      </div>
    </div>
  `;
  
  container.appendChild(toast);
  
  // Trigger animation
  setTimeout(() => toast.classList.add('show'), 10);
  
  // Auto dismiss
  setTimeout(() => {
    toast.classList.remove('show');
    toast.classList.add('hide');
    setTimeout(() => toast.remove(), 400);
  }, duration);
}


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function init() {
  createCarbonParticles();
  renderTransactions();
  updateWeeklyCarbon();
  updateGreenPoints();
  updateLevel();
  updateStreak();
  setupNavigation();
  setupGoalSystem();
  drawCarbonChart();
  
  // Add event listener for QR/Plaid button
  document.getElementById('qrBtn').addEventListener('click', simulateTransactionSync);
  
  // Setup filter tabs
  document.querySelectorAll('.filter-tab').forEach(tab => {
    tab.addEventListener('click', function() {
      document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      const filter = this.getAttribute('data-filter');
      document.querySelectorAll('#transactionsTxnList .txn-item').forEach(item => {
        item.style.display = (filter === 'all' || item.getAttribute('data-impact') === filter) ? 'flex' : 'none';
      });
    });
  });
  
  // Setup profile actions
  document.getElementById('editProfileBtn').addEventListener('click', () => {
    showToast('Coming Soon', 'Edit profile feature is under development', 'üë§');
  });
  
  document.getElementById('logoutBtn').addEventListener('click', () => {
    if (confirm('Are you sure you want to log out?')) {
      showToast('Logging Out', 'See you soon! üëã', 'üö™');
    }
  });
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.addEventListener('click', function() {
      const title = this.querySelector('.menu-title')?.textContent;
      if (title) showToast('Opening', title, 'üì±');
    });
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TRANSACTION SYNC (OFFLINE MODE)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function simulateTransactionSync() {
  // Simulate fetching transactions from your bank
  const mockTransactions = [
    {name:'Uber Ride',desc:'Ride to office',carbon:2.5,impact:'medium',category:'transport',points:15,icon:'üöó'},
    {name:'Amazon Purchase',desc:'Electronics',carbon:3.2,impact:'high',category:'shopping',points:10,icon:'üì¶'},
    {name:'Whole Foods',desc:'Organic groceries',carbon:0.9,impact:'low',category:'food',points:12,icon:'üõí'},
    {name:'Starbucks Coffee',desc:'Morning latte',carbon:0.4,impact:'low',category:'food',points:8,icon:'‚òï'},
    {name:'Target Shopping',desc:'Household items',carbon:1.8,impact:'medium',category:'shopping',points:12,icon:'üõí'},
    {name:'Netflix Subscription',desc:'Streaming service',carbon:0.1,impact:'low',category:'entertainment',points:5,icon:'üì∫'},
    {name:'Shell Gas Station',desc:'Fuel purchase',carbon:4.5,impact:'high',category:'transport',points:8,icon:'‚õΩ'},
    {name:'Local Farmers Market',desc:'Fresh produce',carbon:0.3,impact:'low',category:'food',points:14,icon:'ü•ï'}
  ];
  
  // Randomly select 1-2 transactions
  const numTxns = Math.floor(Math.random() * 2) + 1;
  const selectedTxns = [];
  let totalPoints = 0;
  
  // Get current time for unique IDs
  const now = Date.now();
  
  for (let i = 0; i < numTxns; i++) {
    const txn = mockTransactions[Math.floor(Math.random() * mockTransactions.length)];
    // Create a unique transaction with timestamp ID
    const newTxn = {
      ...txn,
      id: `txn_${now}_${i}`, // Unique ID for each transaction
      timestamp: now + i
    };
    selectedTxns.push(newTxn);
    totalPoints += newTxn.points;
    
    // Add to beginning of array so they show up first in the activity feed
    allTransactions.unshift(newTxn);
  }
  
  // Update UI with new transactions
  renderTransactions();
  
  // Award points and update carbon for the selected transactions
  selectedTxns.forEach(txn => {
    transactionCount++;
    greenPoints += txn.points;
    weeklyCarbon[6] += txn.carbon;
  });
  
  // Update all UI elements
  showFloatingPoints(totalPoints);
  updateWeeklyCarbon();
  updateGreenPoints();
  updateLevel();
  checkGoalStatus();
  drawCarbonChart();
  
  // Show success toast notification
  const txnNames = selectedTxns.map(t => t.name).join(' & ');
  showToast(
    `${numTxns} Transaction${numTxns > 1 ? 's' : ''} Synced!`,
    `${txnNames} ‚Ä¢ +${totalPoints} GP earned üíö`,
    'üîÑ'
  );
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CARBON PARTICLES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function createCarbonParticles() {
  const field = document.getElementById('carbonField');
  for (let i = 0; i < 12; i++) {
    const p = document.createElement('div');
    p.className = 'carbon-particle';
    p.textContent = 'üí®';
    p.style.left = Math.random() * 100 + '%';
    p.style.fontSize = (12 + Math.random() * 14) + 'px';
    p.style.animationDuration = (18 + Math.random() * 14) + 's';
    p.style.animationDelay = Math.random() * 8 + 's';
    field.appendChild(p);
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TRANSACTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderTransactions() {
  const homeList = document.getElementById('homeTxnList');
  const txnList = document.getElementById('transactionsTxnList');
  
  if (!homeList || !txnList) {
    console.error('Transaction list elements not found!');
    return;
  }
  
  homeList.innerHTML = '';
  txnList.innerHTML = '';
  
  // Show top 3 on home page
  allTransactions.slice(0, 3).forEach(txn => {
    homeList.appendChild(createTxnElement(txn));
  });
  
  // Show all on transactions page
  allTransactions.forEach(txn => {
    txnList.appendChild(createTxnElement(txn));
  });
}

function createTxnElement(txn) {
  const div = document.createElement('div');
  div.className = 'txn-item';
  div.setAttribute('data-impact', txn.impact);
  
  // Add unique ID if available and highlight new transactions
  if (txn.id) {
    div.setAttribute('data-txn-id', txn.id);
    div.classList.add('new-txn'); // Add highlight animation for synced transactions
  }
  
  div.innerHTML = `
    <div class="txn-icon ${txn.impact}">
      ${txn.icon}
    </div>
    <div class="txn-info">
      <div class="txn-name">${txn.name}</div>
      <div class="txn-desc">${txn.desc}</div>
    </div>
    <div class="txn-right">
      <div class="txn-carbon ${txn.impact}">${txn.carbon.toFixed(1)} kg</div>
      <div class="txn-points">+${txn.points} GP</div>
    </div>
  `;
  
  // Transactions are display-only, not clickable for adding points
  // Points are only added through camera icon sync
  
  return div;
}

// addTransaction function removed - transactions are display-only
// Points are only added through camera icon sync
/*
function addTransaction(txn) {
  transactionCount++;
  greenPoints += txn.points;
  
  // Update weekly carbon data
  weeklyCarbon[6] += txn.carbon;
  
  // Show floating points animation
  showFloatingPoints(txn.points);
  
  updateWeeklyCarbon();
  updateGreenPoints();
  updateLevel();
  checkGoalStatus();
  drawCarbonChart();
  
  // Visual feedback
  const btn = event.currentTarget;
  btn.style.transform = 'scale(0.95)';
  setTimeout(() => btn.style.transform = '', 200);
}
*/

function showFloatingPoints(points) {
  const floating = document.createElement('div');
  floating.className = 'points-floating';
  floating.textContent = `+${points} GP`;
  floating.style.left = '50%';
  floating.style.top = '50%';
  floating.style.transform = 'translate(-50%, -50%)';
  document.body.appendChild(floating);
  setTimeout(() => floating.remove(), 1500);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// GREEN POINTS & GAMIFICATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function updateGreenPoints() {
  document.getElementById('greenPoints').textContent = greenPoints;
  document.getElementById('rewardsGP').textContent = greenPoints;
  document.getElementById('profileGP').textContent = greenPoints;
}

function updateLevel() {
  // Level thresholds: 250, 600, 1200, 2000, etc.
  const levels = [0, 250, 600, 1200, 2000, 3500, 5500];
  let newLevel = 1;
  
  for (let i = 0; i < levels.length; i++) {
    if (greenPoints >= levels[i]) {
      newLevel = i + 1;
    }
  }
  
  userLevel = newLevel;
  document.getElementById('userLevel').textContent = userLevel;
  document.getElementById('profileLevel').textContent = userLevel;
  
  // Calculate progress to next level
  const currentThreshold = levels[userLevel - 1] || 0;
  const nextThreshold = levels[userLevel] || levels[levels.length - 1];
  const progress = ((greenPoints - currentThreshold) / (nextThreshold - currentThreshold)) * 100;
  
  document.getElementById('levelProgressFill').style.width = Math.min(progress, 100) + '%';
  document.getElementById('pointsToNext').textContent = (nextThreshold - greenPoints) + ' GP';
}

function updateStreak() {
  // Simple streak simulation
  streakDays = Math.min(Math.floor(transactionCount / 3), 30);
  document.getElementById('streakDays').textContent = streakDays;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WEEKLY CARBON TRACKING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function updateWeeklyCarbon() {
  const total = allTransactions.reduce((sum, t) => sum + t.carbon, 0);
  document.getElementById('weekCarbon').textContent = total.toFixed(1);

  const percentUsed = Math.min((total / weeklyGoal) * 100, 100);
  const circumference = 188.5;
  const offset = circumference - (circumference * percentUsed / 100);
  document.getElementById('goalCircle').style.strokeDashoffset = offset;
  document.querySelector('.goal-ring-label span').textContent = Math.round(percentUsed) + '%';

  const remaining = Math.max(weeklyGoal - total, 0);
  document.querySelector('.goal-info .main').textContent = `${remaining.toFixed(1)} kg away from your Green Goal`;

  const badge = document.getElementById('weeklyBadge');
  if (total >= weeklyGoal) {
    badge.textContent = 'Over Goal';
    badge.style.cssText = 'background:rgba(248,113,113,.15);color:#f87171;border:1px solid rgba(248,113,113,.3);';
  } else if (remaining < weeklyGoal * 0.2) {
    badge.textContent = 'Almost There!';
    badge.style.cssText = 'background:rgba(251,191,36,.15);color:#fbbf24;border:1px solid rgba(251,191,36,.3);';
  } else {
    badge.textContent = 'On Track';
    badge.style.cssText = 'background:rgba(74,222,128,.1);color:#4ade80;border:1px solid rgba(74,222,128,.25);';
  }

  document.getElementById('weeklyRemaining').textContent = `${remaining.toFixed(1)}`;
  document.getElementById('weeklyUsed').textContent = `${total.toFixed(1)}`;
  document.getElementById('weeklyGoalDisplay').textContent = `${weeklyGoal.toFixed(1)}`;
  document.getElementById('profileTotalCarbon').textContent = total.toFixed(1);

  // Check if goal achieved
  if (transactionCount >= 3 && total < weeklyGoal && goalStatus === 'active') {
    setTimeout(awardGreenPoints, 500);
  }

  // Keep breakdown in sync
  updateCarbonBreakdown();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CARBON BREAKDOWN BY CATEGORY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function updateCarbonBreakdown() {
  // Sum carbon by category from all transactions
  const totals = { transport: 0, food: 0, shopping: 0, energy: 0 };

  allTransactions.forEach(txn => {
    const cat = txn.category;
    if (cat === 'transport') totals.transport += txn.carbon;
    else if (cat === 'food') totals.food += txn.carbon;
    else if (cat === 'shopping') totals.shopping += txn.carbon;
    else if (cat === 'energy') totals.energy += txn.carbon;
    // 'entertainment' and others are not tracked in breakdown
  });

  const grandTotal = totals.transport + totals.food + totals.shopping + totals.energy || 1;

  const categories = [
    { key: 'transport', valueId: 'transportValue', barId: 'transportBar' },
    { key: 'food',      valueId: 'foodValue',      barId: 'foodBar'      },
    { key: 'shopping',  valueId: 'shoppingValue',  barId: 'shoppingBar'  },
    { key: 'energy',    valueId: 'energyValue',    barId: 'energyBar'    },
  ];

  categories.forEach(({ key, valueId, barId }) => {
    const val = totals[key];
    const pct = Math.min((val / grandTotal) * 100, 100).toFixed(1);
    const el = document.getElementById(valueId);
    const bar = document.getElementById(barId);
    if (el) el.textContent = val.toFixed(1) + ' kg';
    if (bar) bar.style.width = pct + '%';
  });
}

function checkGoalStatus() {
  const total = allTransactions.reduce((sum, t) => sum + t.carbon, 0);
  const alert = document.getElementById('goalStatusAlert');

  if (goalStatus === 'active') {
    if (total >= weeklyGoal) {
      goalStatus = 'failed';
      alert.classList.remove('hidden','success');
      alert.classList.add('failed');
      document.getElementById('goalStatusIcon').textContent = 'üò¢';
      document.getElementById('goalStatusTitle').textContent = 'Goal Failed!';
      document.getElementById('goalStatusMessage').textContent = `You exceeded your ${weeklyGoal.toFixed(1)}kg goal. Try again next week!`;
      setTimeout(() => alert.classList.add('hidden'), 5000);
    }
  }
}

function awardGreenPoints() {
  const total = allTransactions.reduce((sum, t) => sum + t.carbon, 0);
  if (goalStatus === 'active' && total < weeklyGoal && transactionCount >= 3) {
    goalStatus = 'success';
    greenPoints += 50;
    updateGreenPoints();
    updateLevel();
    
    const alert = document.getElementById('goalStatusAlert');
    alert.classList.remove('hidden','failed');
    alert.classList.add('success');
    document.getElementById('goalStatusIcon').textContent = 'üéâ';
    document.getElementById('goalStatusTitle').textContent = 'Goal Achieved!';
    document.getElementById('goalStatusMessage').textContent = 'You earned 50 Green Points! Keep up the great work!';
    
    showFloatingPoints(50);
    setTimeout(() => alert.classList.add('hidden'), 6000);
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// GOAL SYSTEM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function setupGoalSystem() {
  document.getElementById('setGoalBtn').addEventListener('click', () => {
    document.getElementById('goalInput').value = weeklyGoal.toFixed(1);
    document.getElementById('goalModal').classList.add('open');
  });

  document.querySelectorAll('.goal-suggest-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      document.getElementById('goalInput').value = parseFloat(this.getAttribute('data-goal')).toFixed(1);
    });
  });

  document.getElementById('goalSaveBtn').addEventListener('click', function() {
    const newGoal = parseFloat(document.getElementById('goalInput').value);
    if (newGoal && newGoal > 0 && newGoal <= 100) {
      weeklyGoal = newGoal;
      goalStatus = 'active';
      document.getElementById('goalStatusAlert').classList.add('hidden');
      closeGoalModal();
      updateWeeklyCarbon();
      
      const orig = this.textContent;
      this.textContent = '‚úì Goal Saved!';
      this.style.opacity = '0.8';
      setTimeout(() => { this.textContent = orig; this.style.opacity = ''; }, 1500);
    } else {
      showToast('Invalid Goal', 'Please enter a valid goal between 1 and 100 kg CO‚ÇÇ', '‚ö†Ô∏è');
    }
  });

  document.getElementById('goalCancelBtn').addEventListener('click', closeGoalModal);
  document.getElementById('goalModal').addEventListener('click', e => {
    if (e.target === document.getElementById('goalModal')) closeGoalModal();
  });
}

function closeGoalModal() {
  document.getElementById('goalModal').classList.remove('open');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CARBON CHART
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function drawCarbonChart() {
  const canvas = document.getElementById('carbonChart');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  
  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  ctx.scale(dpr, dpr);
  
  const width = rect.width;
  const height = rect.height;
  const padding = 30;
  const chartWidth = width - padding * 2;
  const chartHeight = height - padding * 2;
  
  // Calculate max value for scaling
  const dailyGoal = weeklyGoal / 7;
  const maxValue = Math.max(...weeklyCarbon, dailyGoal) * 1.2;
  
  // Draw grid lines
  ctx.strokeStyle = 'rgba(255,255,255,0.05)';
  ctx.lineWidth = 1;
  for (let i = 0; i <= 4; i++) {
    const y = padding + (chartHeight / 4) * i;
    ctx.beginPath();
    ctx.moveTo(padding, y);
    ctx.lineTo(width - padding, y);
    ctx.stroke();
  }
  
  // Draw goal line
  const goalY = padding + chartHeight - (dailyGoal / maxValue) * chartHeight;
  ctx.strokeStyle = 'rgba(251,191,36,0.4)';
  ctx.lineWidth = 2;
  ctx.setLineDash([5, 5]);
  ctx.beginPath();
  ctx.moveTo(padding, goalY);
  ctx.lineTo(width - padding, goalY);
  ctx.stroke();
  ctx.setLineDash([]);
  
  // Draw bars
  const barWidth = chartWidth / 7 * 0.6;
  const barSpacing = chartWidth / 7;
  
  for (let i = 0; i < weeklyCarbon.length; i++) {
    const value = weeklyCarbon[i];
    const barHeight = (value / maxValue) * chartHeight;
    const x = padding + barSpacing * i + (barSpacing - barWidth) / 2;
    const y = padding + chartHeight - barHeight;
    
    // Determine color based on goal
    let gradient;
    if (value <= dailyGoal) {
      gradient = ctx.createLinearGradient(x, y, x, y + barHeight);
      gradient.addColorStop(0, '#4ade80');
      gradient.addColorStop(1, '#16a34a');
    } else {
      gradient = ctx.createLinearGradient(x, y, x, y + barHeight);
      gradient.addColorStop(0, '#fb923c');
      gradient.addColorStop(1, '#f87171');
    }
    
    ctx.fillStyle = gradient;
    ctx.fillRect(x, y, barWidth, barHeight);
    
    // Add glow effect
    ctx.shadowColor = value <= dailyGoal ? 'rgba(74,222,128,0.4)' : 'rgba(248,113,113,0.4)';
    ctx.shadowBlur = 10;
    ctx.fillRect(x, y, barWidth, barHeight);
    ctx.shadowBlur = 0;
    
    // Draw value on top
    if (value > 0) {
      ctx.fillStyle = '#e8fced';
      ctx.font = '11px DM Sans';
      ctx.textAlign = 'center';
      ctx.fillText(value.toFixed(1), x + barWidth / 2, y - 5);
    }
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// REWARDS & MERCHANTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const rewardData = {
  solar: {
    icon: '‚òÄÔ∏è',
    title: 'Solar Panel Discount',
    subtitle: 'Renewable Energy Investment',
    description: 'Get 10% off professional solar panel installation from certified partners. Convert your home to clean, renewable energy and reduce your carbon footprint by up to 80%.',
    features: [
      {icon: 'üí∞', text: 'Save $1,000-$3,000 on installation'},
      {icon: 'üîã', text: '25-year performance warranty'},
      {icon: 'üìä', text: 'Free energy audit included'},
      {icon: 'üèÜ', text: 'Tax credits & incentives guidance'}
    ],
    terms: 'Valid for 90 days. One-time use only. Cannot be combined with other offers. Minimum system size 5kW.',
    cost: 100,
    url: 'https://www.sunrun.com'
  },
  ev: {
    icon: '‚ö°',
    title: 'EV Charging Free Month',
    subtitle: 'Electric Vehicle Charging',
    description: 'Get 1 month of unlimited charging at any EcoCharge station nationwide. Perfect for electric vehicle owners looking to reduce charging costs.',
    features: [
      {icon: 'üîå', text: 'Unlimited charging sessions'},
      {icon: 'üó∫Ô∏è', text: '2,000+ stations nationwide'},
      {icon: '‚ö°', text: 'Fast charging available'},
      {icon: 'üì±', text: 'Mobile app access'}
    ],
    terms: 'Valid for 30 days from activation. One vehicle only. Not valid for commercial use.',
    cost: 150,
    url: 'https://www.chargepoint.com'
  },
  wind: {
    icon: 'üåä',
    title: 'Wind Energy Plan Discount',
    subtitle: '100% Renewable Electricity',
    description: 'Switch to 100% wind-powered electricity with 15% off your first year. Support clean energy and reduce your home carbon emissions to zero.',
    features: [
      {icon: 'üí®', text: '100% wind-generated power'},
      {icon: 'üìâ', text: '15% off for 12 months'},
      {icon: 'üåç', text: 'Carbon-neutral certified'},
      {icon: 'üìä', text: 'Monthly impact reports'}
    ],
    terms: '12-month contract required. Discount applies to energy charges only. Available in select regions.',
    cost: 300,
    url: 'https://www.greenmountainenergy.com'
  },
  tree: {
    icon: 'üå≥',
    title: 'Plant 10 Trees',
    subtitle: 'Reforestation Project',
    description: 'Plant 10 trees in your name through our verified reforestation partners. Each tree absorbs approximately 48 lbs of CO‚ÇÇ per year.',
    features: [
      {icon: 'üå±', text: '10 trees planted in verified forests'},
      {icon: 'üìç', text: 'GPS coordinates of your trees'},
      {icon: 'üì∏', text: 'Planting photos & certificates'},
      {icon: 'üåç', text: '~480 lbs CO‚ÇÇ absorbed annually'}
    ],
    terms: 'Trees planted within 30 days. Located in reforestation zones. Tracking updates quarterly.',
    cost: 500,
    url: 'https://onetreeplanted.org'
  },
  coffee: {
    icon: '‚òï',
    title: 'Eco Caf√© Voucher',
    subtitle: 'Sustainable Coffee',
    description: '$5 voucher for eco-friendly caf√©s partnered with CarbonCash. Valid at 200+ locations serving organic, fair-trade coffee.',
    features: [
      {icon: '‚òï', text: 'Valid at 200+ locations'},
      {icon: 'üå±', text: 'Organic & fair-trade only'},
      {icon: '‚ôªÔ∏è', text: 'Zero-waste packaging'},
      {icon: 'üíö', text: 'Support local businesses'}
    ],
    terms: 'Valid for 60 days. One-time use. Cannot be split or combined.',
    cost: 25,
    url: 'https://www.groundworkscoffee.com'
  },
  'bike-rental': {
    icon: 'üö≤',
    title: 'Bike Rental Week',
    subtitle: 'Green Transportation',
    description: 'Get 1 week of free bike rental from BikeShare City. Access thousands of bikes across the city for zero-emission travel.',
    features: [
      {icon: 'üö¥', text: '7 days unlimited rides'},
      {icon: 'üìç', text: '300+ pickup/drop stations'},
      {icon: 'üîê', text: 'No deposit required'},
      {icon: 'üì±', text: 'Easy app unlock'}
    ],
    terms: 'Valid for 7 consecutive days. Standard bikes only. Damage fees may apply.',
    cost: 40,
    url: 'https://www.lyft.com/bikes'
  },
  transit: {
    icon: 'üöá',
    title: 'Transit Pass Month',
    subtitle: 'Public Transportation',
    description: '1 month unlimited public transit pass for buses, trains, and metro. Reduce your carbon footprint while saving on commute costs.',
    features: [
      {icon: 'üöå', text: 'All buses, trains & metro'},
      {icon: 'üìÖ', text: '30 days unlimited rides'},
      {icon: 'üíµ', text: 'Save ~$100/month'},
      {icon: 'üåç', text: 'Reduce CO‚ÇÇ by 4.6 lbs/day'}
    ],
    terms: 'Valid for 30 days from first use. Non-transferable. Express routes included.',
    cost: 120,
    url: 'https://www.transitapp.com'
  },
  organic: {
    icon: 'ü•ó',
    title: 'Organic Produce Box',
    subtitle: 'Farm Fresh Delivery',
    description: 'Weekly organic produce box delivered to your door. Seasonal fruits and vegetables from local certified organic farms.',
    features: [
      {icon: 'üåæ', text: 'Certified organic produce'},
      {icon: 'üöö', text: 'Free home delivery'},
      {icon: 'üë®‚Äçüåæ', text: 'Support local farms'},
      {icon: 'üì¶', text: '15-20 items per box'}
    ],
    terms: 'One delivery only. Available in select zip codes. Substitutions may occur based on availability.',
    cost: 60,
    url: 'https://www.imperfectfoods.com'
  }
};

const merchantData = {
  solar: {
    icon: '‚òÄÔ∏è',
    name: 'SolarPro Solutions',
    category: 'Renewable Energy',
    description: 'Leading solar panel installer with 15+ years of experience. Certified installers, premium equipment, and industry-best warranties. Join 10,000+ satisfied customers who have switched to solar.',
    features: [
      {icon: '‚≠ê', text: '15+ years in business'},
      {icon: 'üë•', text: '10,000+ installations'},
      {icon: 'üõ°Ô∏è', text: '25-year warranty'},
      {icon: 'üí∞', text: 'Flexible financing options'}
    ],
    stats: [
      {label: 'GP/Purchase', value: '30'},
      {label: 'Max Discount', value: '15%'},
      {label: 'Avg. Savings', value: '$2,500'}
    ],
    terms: 'Earn 30 GP per $100 spent. Unlock 15% discount with 200+ GP. Free consultation included.',
    url: 'https://www.sunrun.com'
  },
  ev: {
    icon: '‚ö°',
    name: 'EcoCharge Network',
    category: 'EV Charging',
    description: 'Nation\'s largest EV charging network with 2,100+ stations. Fast charging, reliable service, and competitive rates. Mobile app for easy station location and payment.',
    features: [
      {icon: 'üó∫Ô∏è', text: '2,100+ charging stations'},
      {icon: '‚ö°', text: 'Level 2 & DC fast charging'},
      {icon: 'üì±', text: 'iOS & Android apps'},
      {icon: 'üí≥', text: 'Pay-as-you-go or subscription'}
    ],
    stats: [
      {label: 'GP/Session', value: '5'},
      {label: 'Stations', value: '2,100'},
      {label: 'Avg. Speed', value: '30 min'}
    ],
    terms: 'Earn 5 GP per charging session. Free charging available with 150+ GP membership.',
    url: 'https://www.chargepoint.com'
  },
  grocer: {
    icon: 'üåø',
    name: 'GreenGrocer Market',
    category: 'Organic Food',
    description: 'Your neighborhood organic market featuring locally-sourced produce, sustainable products, and zero-waste options. Supporting local farmers and reducing food miles.',
    features: [
      {icon: 'üåæ', text: 'Certified organic produce'},
      {icon: 'üë®‚Äçüåæ', text: 'Local farm partnerships'},
      {icon: '‚ôªÔ∏è', text: 'Zero-waste bulk section'},
      {icon: 'ü•¨', text: 'Seasonal selections'}
    ],
    stats: [
      {label: 'GP/Week', value: '20'},
      {label: 'Discount', value: '10%'},
      {label: 'Locations', value: '45'}
    ],
    terms: 'Earn 2 GP per $10 spent. 10% discount on organic produce with 100+ GP.',
    url: 'https://www.wholefoodsmarket.com'
  },
  bike: {
    icon: 'üö¥',
    name: 'BikeShare City',
    category: 'Green Transport',
    description: 'City-wide bike sharing with 300+ stations. Perfect for short trips, exercise, and reducing your carbon footprint. Easy unlock with our mobile app.',
    features: [
      {icon: 'üö≤', text: '1,000+ bikes available'},
      {icon: 'üìç', text: '300+ stations citywide'},
      {icon: 'üì±', text: 'Quick app unlock'},
      {icon: 'üîí', text: 'Secure parking stations'}
    ],
    stats: [
      {label: 'GP/Ride', value: '3'},
      {label: 'Pass Discount', value: '20%'},
      {label: 'Avg. Trip', value: '15 min'}
    ],
    terms: 'Earn 3 GP per ride. Monthly pass 20% off with 80+ GP.',
    url: 'https://www.lyft.com/bikes'
  },
  recycle: {
    icon: '‚ôªÔ∏è',
    name: 'RecycleHub',
    category: 'Waste Management',
    description: 'Comprehensive recycling and waste management services. Accept electronics, batteries, plastics, paper, and more. Proper disposal guaranteed.',
    features: [
      {icon: 'üì±', text: 'Electronics recycling'},
      {icon: 'üîã', text: 'Battery disposal'},
      {icon: 'üóëÔ∏è', text: 'Hazardous waste accepted'},
      {icon: 'üìú', text: 'Certified disposal'}
    ],
    stats: [
      {label: 'GP/Drop-off', value: '10'},
      {label: 'Materials', value: '50+'},
      {label: 'Centers', value: '120'}
    ],
    terms: 'Earn 10 GP per recycling drop-off. Bonus 50 GP for electronics.',
    url: 'https://www.earth911.com'
  }
};

const investmentData = {
  'solar': {
    icon: '‚òÄÔ∏è',
    title: 'Solar Panel Installation',
    subtitle: 'Renewable Energy Investment',
    description: 'Professional solar panel installation with 10% discount. Reduce your electricity bills by 50-90% and increase home value. Federal tax credits available for up to 30% of system cost.',
    features: [
      {icon: 'üí∞', text: 'ROI in 5-7 years typically'},
      {icon: 'üè†', text: 'Increases home value by $15k+'},
      {icon: '‚ö°', text: 'Net metering credit available'},
      {icon: 'üõ°Ô∏è', text: '25-year performance warranty'}
    ],
    stats: [
      {label: 'GP Cost', value: '100'},
      {label: 'You Save', value: '10%'},
      {label: 'Avg. System', value: '$15k'}
    ],
    terms: 'Discount valid for 90 days. Minimum 5kW system. Installation within 60 days of purchase.',
    cost: 100,
    url: 'https://www.sunrun.com'
  },
  'ev-charging': {
    icon: '‚ö°',
    title: 'EV Charging Station',
    subtitle: 'Home Charging Solution',
    description: 'Level 2 home EV charging station with 15% discount. Full charge overnight, 240V installation included. Smart app controls and energy monitoring.',
    features: [
      {icon: 'üîå', text: '7.2kW fast charging'},
      {icon: 'üì±', text: 'WiFi-enabled smart controls'},
      {icon: '‚öôÔ∏è', text: 'Professional installation'},
      {icon: '‚ö°', text: '0-100% in 6-8 hours'}
    ],
    stats: [
      {label: 'GP Cost', value: '150'},
      {label: 'You Save', value: '15%'},
      {label: 'Install Time', value: '4 hrs'}
    ],
    terms: 'Requires 240V circuit. Electrician installation included. 3-year warranty.',
    cost: 150,
    url: 'https://www.chargepoint.com/home'
  },
  'wind-energy': {
    icon: 'üåä',
    title: 'Wind Energy Subscription',
    subtitle: '100% Renewable Electricity',
    description: 'Switch to 100% wind-powered electricity with 20% off first year. No installation needed - just a simple switch. Cancel anytime with no fees.',
    features: [
      {icon: 'üí®', text: '100% wind-generated'},
      {icon: 'üìâ', text: '20% off for 12 months'},
      {icon: 'üåç', text: 'Certified carbon neutral'},
      {icon: 'üìä', text: 'Monthly impact reports'}
    ],
    stats: [
      {label: 'GP Cost', value: '200'},
      {label: 'You Save', value: '20%'},
      {label: 'Contract', value: '12 mo'}
    ],
    terms: '12-month minimum term. Available in select states. Price lock guarantee.',
    cost: 200,
    url: 'https://www.greenmountainenergy.com'
  },
  'green-bonds': {
    icon: 'üìà',
    title: 'Green Bond Investment',
    subtitle: 'Sustainable Finance',
    description: 'Invest in green bonds with +2% APY bonus. Support renewable energy, sustainable agriculture, and climate projects while earning competitive returns.',
    features: [
      {icon: 'üíπ', text: 'Competitive returns + bonus'},
      {icon: 'üå±', text: 'Eco-certified projects only'},
      {icon: 'üîí', text: 'Principal protected'},
      {icon: 'üìà', text: 'Quarterly dividends'}
    ],
    stats: [
      {label: 'GP Cost', value: '300'},
      {label: 'Bonus APY', value: '+2%'},
      {label: 'Min. Investment', value: '$1,000'}
    ],
    terms: 'Minimum $1,000 investment. 2-year term. Bonus APY for first year only.',
    cost: 300,
    url: 'https://www.climatebonds.net'
  },
  'carbon-offset': {
    icon: 'üåç',
    title: 'Carbon Offset Credits',
    subtitle: 'Neutralize Your Footprint',
    description: 'Purchase verified carbon offset credits to neutralize your emissions. Support reforestation, renewable energy, and conservation projects worldwide.',
    features: [
      {icon: 'üå≥', text: '5 tons of CO‚ÇÇ offset'},
      {icon: '‚úì', text: 'Gold Standard certified'},
      {icon: 'üìç', text: 'Project location tracking'},
      {icon: 'üìú', text: 'Official certificate'}
    ],
    stats: [
      {label: 'GP Cost', value: '80'},
      {label: 'CO‚ÇÇ Offset', value: '5 tons'},
      {label: 'Projects', value: '20+'}
    ],
    terms: 'Credits retired upon purchase. Certificate delivered via email. Valid internationally.',
    cost: 80,
    url: 'https://www.goldstandard.org'
  }
};

function showRewardDetail(type, cost) {
  const data = rewardData[type];
  if (!data) return;
  
  const modal = document.getElementById('detailModal');
  document.getElementById('detailIcon').textContent = data.icon;
  document.getElementById('detailTitle').textContent = data.title;
  document.getElementById('detailSubtitle').textContent = data.subtitle;
  document.getElementById('detailDescription').textContent = data.description;
  
  // Show/hide claimed badge
  const claimedBadge = document.getElementById('detailClaimedBadge');
  if (claimedRewards.has(type)) {
    claimedBadge.style.display = 'block';
  } else {
    claimedBadge.style.display = 'none';
  }
  
  // Hide stats section for rewards
  document.getElementById('detailStatsSection').style.display = 'none';
  
  // Populate features
  const featuresSection = document.getElementById('detailFeaturesSection');
  const featuresList = document.getElementById('detailFeatures');
  featuresSection.style.display = 'block';
  featuresList.innerHTML = data.features.map(f => 
    `<div class="detail-feature">
      <div class="detail-feature-icon">${f.icon}</div>
      <div class="detail-feature-text">${f.text}</div>
    </div>`
  ).join('');
  
  // Populate terms
  const termsSection = document.getElementById('detailTermsSection');
  termsSection.style.display = 'block';
  document.getElementById('detailTerms').textContent = data.terms;
  
  // Populate actions
  const actions = document.getElementById('detailActions');
  const isClaimed = claimedRewards.has(type);
  const canAfford = greenPoints >= cost;
  
  actions.innerHTML = `
    <div class="detail-btn secondary" onclick="closeDetailModal()">Close</div>
    <div class="detail-btn primary ${isClaimed || !canAfford ? 'disabled' : ''}" 
         onclick="${isClaimed || !canAfford ? '' : `claimReward('${type}', ${cost})`}">
      ${isClaimed ? '‚úì Claimed' : (canAfford ? `Claim for ${cost} GP` : `Need ${cost - greenPoints} more GP`)}
    </div>
  `;
  
  modal.classList.add('open');
}

function showInvestmentDetail(type, cost) {
  const data = investmentData[type];
  if (!data) return;
  
  const modal = document.getElementById('detailModal');
  document.getElementById('detailIcon').textContent = data.icon;
  document.getElementById('detailTitle').textContent = data.title;
  document.getElementById('detailSubtitle').textContent = data.subtitle;
  document.getElementById('detailDescription').textContent = data.description;
  
  // Show/hide claimed badge
  const claimedBadge = document.getElementById('detailClaimedBadge');
  if (claimedRewards.has(type)) {
    claimedBadge.style.display = 'block';
  } else {
    claimedBadge.style.display = 'none';
  }
  
  // Show stats
  const statsSection = document.getElementById('detailStatsSection');
  statsSection.style.display = 'grid';
  statsSection.innerHTML = data.stats.map(s =>
    `<div class="detail-stat">
      <span class="detail-stat-value">${s.value}</span>
      <span class="detail-stat-label">${s.label}</span>
    </div>`
  ).join('');
  
  // Populate features
  const featuresSection = document.getElementById('detailFeaturesSection');
  const featuresList = document.getElementById('detailFeatures');
  featuresSection.style.display = 'block';
  featuresList.innerHTML = data.features.map(f => 
    `<div class="detail-feature">
      <div class="detail-feature-icon">${f.icon}</div>
      <div class="detail-feature-text">${f.text}</div>
    </div>`
  ).join('');
  
  // Populate terms
  const termsSection = document.getElementById('detailTermsSection');
  termsSection.style.display = 'block';
  document.getElementById('detailTerms').textContent = data.terms;
  
  // Populate actions
  const actions = document.getElementById('detailActions');
  const isClaimed = claimedRewards.has(type);
  const canAfford = greenPoints >= cost;
  
  actions.innerHTML = `
    <div class="detail-btn secondary" onclick="closeDetailModal()">Close</div>
    <div class="detail-btn primary ${isClaimed || !canAfford ? 'disabled' : ''}" 
         onclick="${isClaimed || !canAfford ? '' : `redeemInvestment('${type}', ${cost})`}">
      ${isClaimed ? '‚úì Redeemed' : (canAfford ? `Redeem for ${cost} GP` : `Need ${cost - greenPoints} more GP`)}
    </div>
  `;
  
  modal.classList.add('open');
}

function showMerchantDetail(type) {
  const data = merchantData[type];
  if (!data) return;
  
  const modal = document.getElementById('detailModal');
  document.getElementById('detailIcon').textContent = data.icon;
  document.getElementById('detailTitle').textContent = data.name;
  document.getElementById('detailSubtitle').textContent = data.category;
  document.getElementById('detailDescription').textContent = data.description;
  
  // Hide claimed badge
  document.getElementById('detailClaimedBadge').style.display = 'none';
  
  // Show stats
  const statsSection = document.getElementById('detailStatsSection');
  statsSection.style.display = 'grid';
  statsSection.innerHTML = data.stats.map(s =>
    `<div class="detail-stat">
      <span class="detail-stat-value">${s.value}</span>
      <span class="detail-stat-label">${s.label}</span>
    </div>`
  ).join('');
  
  // Populate features
  const featuresSection = document.getElementById('detailFeaturesSection');
  const featuresList = document.getElementById('detailFeatures');
  featuresSection.style.display = 'block';
  featuresList.innerHTML = data.features.map(f => 
    `<div class="detail-feature">
      <div class="detail-feature-icon">${f.icon}</div>
      <div class="detail-feature-text">${f.text}</div>
    </div>`
  ).join('');
  
  // Populate terms
  const termsSection = document.getElementById('detailTermsSection');
  termsSection.style.display = 'block';
  document.getElementById('detailTerms').textContent = data.terms;
  
  // Populate actions
  const actions = document.getElementById('detailActions');
  actions.innerHTML = `
    <div class="detail-btn secondary" onclick="closeDetailModal(); saveMerchant('${type}')">üíö Save</div>
    <div class="detail-btn primary" onclick="closeDetailModal(); visitMerchant('${type}')">
      Visit Store
    </div>
  `;
  
  modal.classList.add('open');
}

function closeDetailModal() {
  document.getElementById('detailModal').classList.remove('open');
}

function claimReward(type, cost) {
  if (claimedRewards.has(type)) {
    closeDetailModal();
    const url = rewardData[type]?.url;
    if (url) {
      showToast('Already Claimed', 'Redirecting you to redeem your reward...', 'üéâ', 2000);
      setTimeout(() => window.open(url, '_blank'), 1200);
    } else {
      showToast('Already Claimed', 'You have already claimed this reward!', '‚ö†Ô∏è');
    }
    return;
  }
  
  if (greenPoints >= cost) {
    greenPoints -= cost;
    claimedRewards.add(type);
    updateGreenPoints();
    updateLevel();
    closeDetailModal();
    
    const rewardName = rewardData[type]?.title || 'Reward';
    const url = rewardData[type]?.url;
    showToast('Reward Claimed! üéâ', `${rewardName} ‚Ä¢ Redirecting you now...`, '‚úÖ', 2500);
    if (url) {
      setTimeout(() => window.open(url, '_blank'), 1500);
    }
  } else {
    closeDetailModal();
    showToast('Not Enough Points', `You need ${cost - greenPoints} more GP to claim this reward`, 'üí∞');
  }
}

function redeemInvestment(type, cost) {
  if (claimedRewards.has(type)) {
    closeDetailModal();
    const url = investmentData[type]?.url;
    if (url) {
      showToast('Already Redeemed', 'Redirecting you to your investment partner...', 'üéâ', 2000);
      setTimeout(() => window.open(url, '_blank'), 1200);
    } else {
      showToast('Already Redeemed', 'You have already redeemed this investment discount!', '‚ö†Ô∏è');
    }
    return;
  }
  
  if (greenPoints >= cost) {
    greenPoints -= cost;
    claimedRewards.add(type);
    updateGreenPoints();
    updateLevel();
    closeDetailModal();
    
    const investmentName = investmentData[type]?.title || 'Investment';
    const url = investmentData[type]?.url;
    showToast('Investment Redeemed! üéâ', `${investmentName} ‚Ä¢ Redirecting you now...`, '‚úÖ', 2500);
    if (url) {
      setTimeout(() => window.open(url, '_blank'), 1500);
    }
  } else {
    closeDetailModal();
    showToast('Not Enough Points', `You need ${cost - greenPoints} more GP for this investment`, 'üí∞');
  }
}

function visitMerchant(merchant) {
  const url = merchantData[merchant]?.url;
  const name = merchantData[merchant]?.name || merchant;
  if (url) {
    showToast('Opening Store', `Redirecting to ${name}...`, 'üè™', 2000);
    setTimeout(() => window.open(url, '_blank'), 800);
  } else {
    showToast('Opening Store', `Redirecting to ${name} merchant page...`, 'üè™');
  }
}

function saveMerchant(merchant) {
  showToast('Saved!', `${merchant} added to your favorites üíö`, '‚≠ê');
}


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAVIGATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function setupNavigation() {
  document.querySelectorAll('.nav-item').forEach(item => {
    item.addEventListener('click', function() {
      const targetPage = this.getAttribute('data-page');
      navigateTo(targetPage);
    });
  });
}

function navigateTo(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  
  document.getElementById(pageId).classList.add('active');
  document.querySelector(`[data-page="${pageId}"]`)?.classList.add('active');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// START APP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// Wait for DOM to be ready, then initialize
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', init);
} else {
  init();
}
</script>
</body>
</html>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïêÔ