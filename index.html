<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>CarbonCash â€“ Carbon Footprint Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,300;9..144,500;9..144,600;9..144,700;9..144,800&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,300&display=swap" rel="stylesheet">
<style>
:root {
  --bg-deep:    #050e08;
  --bg-card:    #0b1a0f;
  --bg-glass:   rgba(14,30,18,0.88);
  --green-glow: #22c55e;
  --green-mid:  #16a34a;
  --green-dark: #14532d;
  --leaf-light: #4ade80;
  --leaf-pale:  #86efac;
  --gold:       #fbbf24;
  --gold-dark:  #d97706;
  --red:        #f87171;
  --orange:     #fb923c;
  --blue:       #38bdf8;
  --text-pri:   #e8fced;
  --text-muted: #6b9a7a;
  --border:     rgba(34,197,94,0.13);
  --r:          22px;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{background:var(--bg-deep);color:var(--text-pri);font-family:'DM Sans',sans-serif;width:100%;height:100%;overflow:hidden;}

/* â”€â”€ Ambient BG â”€â”€ */
body::before{content:'';position:fixed;inset:0;background:
  radial-gradient(ellipse 55% 45% at 20% -5%,rgba(22,163,74,.16) 0%,transparent 65%),
  radial-gradient(ellipse 45% 55% at 80% 105%,rgba(20,83,45,.25) 0%,transparent 60%);
  pointer-events:none;z-index:0;}

/* â”€â”€ Carbon particles floating â”€â”€ */
.carbon-field{position:fixed;inset:0;pointer-events:none;z-index:1;overflow:hidden;}
.carbon-particle{position:absolute;opacity:0;animation:floatCarbon linear infinite;}
@keyframes floatCarbon{
  0%  {transform:translateY(110vh) translateX(0) rotate(0deg) scale(.8);opacity:0;}
  6%  {opacity:.3;}
  90% {opacity:.15;}
  100%{transform:translateY(-15vh) translateX(40px) rotate(380deg) scale(.5);opacity:0;}
}

/* â”€â”€ App shell â”€â”€ */
.app{position:fixed;inset:0;z-index:2;max-width:430px;margin:0 auto;display:flex;flex-direction:column;box-shadow:0 0 60px rgba(0,0,0,.8);}

/* â”€â”€ Page system â”€â”€ */
.pages{flex:1;min-height:0;position:relative;overflow:hidden;}
.page{position:absolute;inset:0;overflow-y:auto;overflow-x:hidden;padding-bottom:12px;
  opacity:0;transform:translateX(30px);pointer-events:none;-webkit-overflow-scrolling:touch;
  transition:opacity .35s cubic-bezier(.4,0,.2,1),transform .35s cubic-bezier(.4,0,.2,1);}
.page.active{opacity:1;transform:translateX(0);pointer-events:all;}

/* â”€â”€ Header â”€â”€ */
.header{padding:16px 24px 0;display:flex;justify-content:space-between;align-items:center;}
.logo{display:flex;align-items:center;gap:8px;font-family:'Fraunces',serif;
  font-size:24px;font-weight:600;color:var(--leaf-light);letter-spacing:-.5px;}
.logo-icon{width:34px;height:34px;background:linear-gradient(135deg,#16a34a,#4ade80);
  border-radius:10px;display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 18px rgba(74,222,128,.35);animation:logoPulse 3s ease-in-out infinite;}
@keyframes logoPulse{0%,100%{box-shadow:0 0 18px rgba(74,222,128,.35);}50%{box-shadow:0 0 32px rgba(74,222,128,.6),0 0 60px rgba(74,222,128,.2);}}
.qr-btn{width:38px;height:38px;border-radius:12px;background:var(--bg-glass);
  border:1px solid var(--border);display:flex;align-items:center;justify-content:center;
  cursor:pointer;backdrop-filter:blur(10px);position:relative;transition:transform .2s;}
.qr-btn:hover{transform:scale(1.08);}

/* â”€â”€ Greeting â”€â”€ */
.greeting{padding:18px 24px 0;}
.greeting .sub{font-size:13px;color:var(--text-muted);margin-bottom:3px;}
.greeting .name{font-family:'Fraunces',serif;font-size:28px;font-weight:700;
  background:linear-gradient(90deg,#4ade80,#86efac,#d4a853);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}

/* â”€â”€ Carbon Impact Card â”€â”€ */
.impact-card{margin:20px 20px 0;
  background:linear-gradient(145deg,#0d2016 0%,#0a1c12 50%,#0f2719 100%);
  border:1px solid rgba(74,222,128,.17);border-radius:28px;padding:24px 26px;
  position:relative;overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,.55),0 0 0 1px rgba(74,222,128,.05) inset;}
.impact-card::before{content:'';position:absolute;top:-60px;right:-60px;width:200px;height:200px;
  background:radial-gradient(circle,rgba(34,197,94,.11) 0%,transparent 70%);
  animation:cardGlow 4s ease-in-out infinite;}
@keyframes cardGlow{0%,100%{opacity:.6;transform:scale(1);}50%{opacity:1;transform:scale(1.3);}}

.impact-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px;}
.impact-left{}
.impact-label{font-size:11px;color:var(--text-muted);letter-spacing:.8px;text-transform:uppercase;margin-bottom:8px;}
.carbon-amount{font-family:'Fraunces',serif;font-size:48px;font-weight:700;
  background:linear-gradient(135deg,#f87171,#fb923c);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  line-height:1;display:flex;align-items:baseline;gap:4px;}
.carbon-amount .unit{font-size:20px;color:var(--text-muted);}

.goal-ring{width:68px;height:68px;position:relative;}
.goal-ring svg{transform:rotate(-90deg);}
.goal-ring-label{position:absolute;inset:0;display:flex;flex-direction:column;
  align-items:center;justify-content:center;font-size:13px;font-weight:700;
  color:var(--leaf-light);line-height:1;}
.goal-ring-label small{font-size:9px;color:var(--text-muted);font-weight:400;}

.goal-info{background:rgba(251,146,60,.08);border:1px solid rgba(251,146,60,.2);
  border-radius:16px;padding:12px 16px;display:flex;align-items:center;gap:12px;}
.goal-icon{font-size:24px;filter:drop-shadow(0 0 8px rgba(251,146,60,.4));}
.goal-text{flex:1;}
.goal-text .main{font-size:14px;font-weight:600;color:var(--text-pri);margin-bottom:2px;}
.goal-text .sub{font-size:11px;color:var(--text-muted);}

/* â”€â”€ Goal Setting Card â”€â”€ */
.goal-setting-card{margin:20px 20px 0;background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r);padding:20px;position:relative;overflow:hidden;}
.goal-setting-card::before{content:'';position:absolute;top:-40px;right:-40px;width:120px;height:120px;
  background:radial-gradient(circle,rgba(34,197,94,.06) 0%,transparent 70%);}
.goal-setting-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;}
.goal-setting-title{font-size:14px;font-weight:600;color:var(--text-pri);margin-bottom:4px;}
.goal-setting-subtitle{font-size:11px;color:var(--text-muted);}
.set-goal-btn{background:rgba(74,222,128,.1);border:1px solid rgba(74,222,128,.25);
  border-radius:10px;padding:6px 12px;font-size:12px;font-weight:600;color:var(--leaf-light);
  cursor:pointer;display:flex;align-items:center;gap:6px;transition:all .2s;}
.set-goal-btn:hover{background:rgba(74,222,128,.15);transform:translateY(-1px);}
.goal-display{display:flex;justify-content:space-between;align-items:center;}
.goal-amount-display{display:flex;align-items:baseline;gap:6px;}
.goal-value{font-family:'Fraunces',serif;font-size:36px;font-weight:700;color:var(--leaf-light);}
.goal-unit{font-size:14px;color:var(--text-muted);}
.green-points-badge{background:linear-gradient(135deg,rgba(251,191,36,.15),rgba(251,146,60,.1));
  border:1px solid rgba(251,191,36,.3);border-radius:14px;padding:10px 14px;display:flex;
  align-items:center;gap:10px;}
.gp-icon{font-size:24px;filter:drop-shadow(0 0 8px rgba(251,191,36,.4));}
.gp-info{text-align:right;}
.gp-value{font-size:20px;font-weight:700;color:var(--gold);line-height:1;}
.gp-label{font-size:9px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.6px;margin-top:2px;}

/* â”€â”€ Goal Status Alert â”€â”€ */
.goal-status-alert{margin:16px 20px 0;border-radius:var(--r);padding:16px 18px;
  display:flex;align-items:center;transition:all .4s cubic-bezier(.4,0,.2,1);
  transform-origin:top;opacity:1;max-height:100px;}
.goal-status-alert.hidden{opacity:0;max-height:0;padding:0;margin:0;overflow:hidden;}
.goal-status-alert.success{background:linear-gradient(135deg,rgba(74,222,128,.15),rgba(34,197,94,.1));
  border:1px solid rgba(74,222,128,.3);}
.goal-status-alert.failed{background:linear-gradient(135deg,rgba(248,113,113,.15),rgba(251,146,60,.1));
  border:1px solid rgba(248,113,113,.3);}
.goal-status-content{display:flex;align-items:center;gap:12px;width:100%;}
.goal-status-icon{font-size:32px;flex-shrink:0;}
.goal-status-text{flex:1;}
.goal-status-title{font-size:15px;font-weight:700;color:var(--text-pri);margin-bottom:3px;}
.goal-status-message{font-size:12px;color:var(--text-muted);}

/* â”€â”€ Goal Setting Modal Input â”€â”€ */
.goal-input{width:100%;background:rgba(255,255,255,.03);border:1px solid var(--border);
  border-radius:12px;padding:14px 16px;font-size:18px;font-weight:600;color:var(--text-pri);
  font-family:'Fraunces',serif;text-align:center;transition:all .2s;}
.goal-input:focus{outline:none;border-color:rgba(74,222,128,.4);background:rgba(74,222,128,.05);}
.goal-suggestions{display:flex;gap:8px;margin-top:12px;}
.goal-suggest-btn{flex:1;background:rgba(255,255,255,.03);border:1px solid var(--border);
  border-radius:10px;padding:10px 8px;font-size:12px;font-weight:600;color:var(--text-muted);
  cursor:pointer;transition:all .2s;white-space:nowrap;}
.goal-suggest-btn:hover{border-color:rgba(74,222,128,.3);color:var(--leaf-light);
  background:rgba(74,222,128,.08);}

/* â”€â”€ Sections â”€â”€ */
.section-title{padding:24px 24px 12px;font-size:12px;text-transform:uppercase;
  letter-spacing:1.2px;color:var(--text-muted);font-weight:500;}

/* â”€â”€ Transaction items â”€â”€ */
.txn-list{padding:0 20px;}
.txn-item{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r);
  padding:16px 18px;margin-bottom:12px;display:flex;align-items:center;gap:14px;
  cursor:pointer;position:relative;overflow:hidden;transition:all .2s;}
.txn-item:hover{border-color:rgba(74,222,128,.25);box-shadow:0 6px 20px rgba(0,0,0,.3);}
.txn-icon{width:46px;height:46px;border-radius:14px;display:flex;align-items:center;
  justify-content:center;font-size:22px;flex-shrink:0;}
.txn-icon.high{background:linear-gradient(135deg,rgba(248,113,113,.15),rgba(251,146,60,.15));
  border:1px solid rgba(248,113,113,.25);}
.txn-icon.medium{background:linear-gradient(135deg,rgba(251,191,36,.15),rgba(251,146,60,.12));
  border:1px solid rgba(251,191,36,.25);}
.txn-icon.low{background:linear-gradient(135deg,rgba(74,222,128,.15),rgba(34,197,94,.12));
  border:1px solid rgba(74,222,128,.25);}
.txn-info{flex:1;min-width:0;}
.txn-name{font-size:15px;font-weight:600;color:var(--text-pri);margin-bottom:3px;}
.txn-details{font-size:12px;color:var(--text-muted);}
.txn-right{text-align:right;}
.txn-carbon{font-size:15px;font-weight:700;margin-bottom:3px;}
.txn-carbon.high{color:var(--red);}
.txn-carbon.medium{color:var(--gold);}
.txn-carbon.low{color:var(--leaf-light);}
.txn-amount{font-size:11px;color:var(--text-muted);}

/* â”€â”€ Bottom nav â”€â”€ */
.bottom-nav{
  background:rgba(5,14,8,.94);backdrop-filter:blur(24px);border-top:1px solid var(--border);
  display:flex;justify-content:space-around;align-items:center;
  padding:10px 4px 20px;flex-shrink:0;z-index:50;}
.nav-item{display:flex;flex-direction:column;align-items:center;gap:3px;
  cursor:pointer;padding:6px 14px;border-radius:14px;transition:background .2s;border:none;background:none;}
.nav-item.active{background:rgba(34,197,94,.1);}
.nav-icon{width:24px;height:24px;display:flex;align-items:center;justify-content:center;color:var(--text-muted);}
.nav-item.active .nav-icon{color:var(--leaf-light);}
.nav-label{font-size:10px;color:var(--text-muted);font-weight:500;}
.nav-item.active .nav-label{color:var(--leaf-light);}

/* â”€â”€ Weekly Goal Card â”€â”€ */
.weekly-card{margin:0 20px 16px;background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r);padding:20px;position:relative;overflow:hidden;}
.weekly-card::before{content:'';position:absolute;top:-40px;right:-40px;width:120px;height:120px;
  background:radial-gradient(circle,rgba(34,197,94,.06) 0%,transparent 70%);}
.weekly-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
.weekly-title{font-size:14px;font-weight:600;color:var(--text-pri);}
.weekly-badge{background:rgba(74,222,128,.1);border:1px solid rgba(74,222,128,.25);
  border-radius:8px;padding:4px 10px;font-size:11px;color:var(--leaf-light);font-weight:600;
  transition:all .3s ease;}
.weekly-progress{position:relative;height:12px;background:rgba(255,255,255,.03);
  border-radius:8px;overflow:hidden;margin-bottom:12px;}
.weekly-progress-bar{height:100%;background:linear-gradient(90deg,#4ade80,#22c55e,#16a34a);
  border-radius:8px;transition:width .6s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;}
.weekly-progress-bar::after{content:'';position:absolute;inset:0;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.25),transparent);
  animation:shimmerBar 2s linear infinite;}
@keyframes shimmerBar{to{transform:translateX(100%);}}
.weekly-stats{display:flex;justify-content:space-between;align-items:center;}
.weekly-stat .val{font-size:18px;font-weight:700;color:var(--text-pri);}
.weekly-stat .lbl{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.6px;}
.weekly-stat.current .val{color:var(--orange);}
.weekly-stat.goal .val{color:var(--leaf-light);}

/* â”€â”€ QR Scan Feedback Banner â”€â”€ */
.scan-banner{position:fixed;top:16px;left:50%;transform:translateX(-50%) translateY(-80px);
  width:calc(100% - 40px);max-width:390px;z-index:999;
  background:linear-gradient(145deg,#0d2016,#0f2719);
  border:1.5px solid rgba(74,222,128,.4);border-radius:20px;padding:14px 18px;
  display:flex;align-items:center;gap:12px;
  box-shadow:0 16px 40px rgba(0,0,0,.6),0 0 0 1px rgba(74,222,128,.08) inset;
  backdrop-filter:blur(20px);transition:transform .4s cubic-bezier(.4,0,.2,1);}
.scan-banner.show{transform:translateX(-50%) translateY(0);}
.scan-banner-icon{font-size:26px;flex-shrink:0;filter:drop-shadow(0 0 8px rgba(74,222,128,.5));}
.scan-banner-body{flex:1;}
.scan-banner-title{font-size:13px;font-weight:700;color:var(--leaf-light);margin-bottom:3px;}
.scan-banner-sub{font-size:12px;color:var(--text-muted);}

/* â”€â”€ Modal for transaction details â”€â”€ */
.modal{position:fixed;inset:0;z-index:9999;display:flex;align-items:flex-end;
  background:rgba(0,0,0,.7);backdrop-filter:blur(6px);
  opacity:0;pointer-events:none;transition:opacity .3s;}
.modal.open{opacity:1;pointer-events:all;}
.modal-sheet{background:linear-gradient(145deg,#0d2016,#0a1c12);
  border-radius:28px 28px 0 0;width:100%;max-width:430px;margin:0 auto;
  max-height:85vh;overflow-y:auto;
  transform:translateY(100%);transition:transform .35s cubic-bezier(.4,0,.2,1);
  border:1px solid rgba(74,222,128,.15);box-shadow:0 -10px 60px rgba(0,0,0,.8);}
.modal.open .modal-sheet{transform:translateY(0);}
.modal-handle{width:40px;height:4px;background:rgba(255,255,255,.15);
  border-radius:2px;margin:12px auto 20px;}
.modal-content{padding:0 24px 32px;}
.modal-header{display:flex;align-items:center;gap:16px;margin-bottom:20px;}
.modal-icon-big{width:64px;height:64px;border-radius:18px;display:flex;
  align-items:center;justify-content:center;font-size:32px;flex-shrink:0;}
.modal-icon-big.high{background:linear-gradient(135deg,rgba(248,113,113,.2),rgba(251,146,60,.2));
  border:1.5px solid rgba(248,113,113,.35);}
.modal-icon-big.medium{background:linear-gradient(135deg,rgba(251,191,36,.2),rgba(251,146,60,.15));
  border:1.5px solid rgba(251,191,36,.35);}
.modal-icon-big.low{background:linear-gradient(135deg,rgba(74,222,128,.2),rgba(34,197,94,.15));
  border:1.5px solid rgba(74,222,128,.35);}
.modal-info h3{font-family:'Fraunces',serif;font-size:22px;font-weight:700;
  color:var(--text-pri);margin-bottom:4px;}
.modal-info .cat{font-size:12px;color:var(--text-muted);}
.modal-divider{height:1px;background:var(--border);margin:20px 0;}
.modal-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
.modal-row .label{font-size:13px;color:var(--text-muted);}
.modal-row .value{font-size:15px;font-weight:600;color:var(--text-pri);}
.modal-row .value.carbon{color:var(--orange);font-size:18px;}
.carbon-breakdown{background:rgba(251,146,60,.06);border:1px solid rgba(251,146,60,.15);
  border-radius:16px;padding:16px;margin-bottom:20px;}
.breakdown-title{font-size:12px;color:var(--text-muted);text-transform:uppercase;
  letter-spacing:.8px;margin-bottom:12px;}
.breakdown-item{display:flex;justify-content:space-between;margin-bottom:8px;}
.breakdown-item:last-child{margin-bottom:0;}
.breakdown-item .name{font-size:13px;color:var(--text-pri);}
.breakdown-item .val{font-size:13px;font-weight:600;color:var(--orange);}
.tip-box{background:rgba(74,222,128,.06);border:1px solid rgba(74,222,128,.2);
  border-radius:16px;padding:16px;display:flex;gap:12px;}
.tip-icon{font-size:24px;flex-shrink:0;}
.tip-text{font-size:13px;color:var(--text-muted);line-height:1.5;}
.tip-text strong{color:var(--leaf-light);}
.modal-close{width:100%;background:linear-gradient(135deg,#16a34a,#22c55e);
  border:none;border-radius:16px;padding:16px;font-size:15px;font-weight:600;
  color:var(--text-pri);cursor:pointer;margin-top:20px;
  box-shadow:0 6px 20px rgba(34,197,94,.25);transition:transform .2s;}
.modal-close:hover{transform:translateY(-2px);}

/* â”€â”€ Responsive â”€â”€ */
@media (max-width: 380px) {
  .carbon-amount{font-size:40px;}
  .goal-ring{width:60px;height:60px;}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TRANSACTIONS PAGE STYLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.filter-tabs{display:flex;gap:8px;padding:12px 20px;overflow-x:auto;scrollbar-width:none;}
.filter-tabs::-webkit-scrollbar{display:none;}
.filter-tab{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;
  padding:8px 16px;font-size:13px;font-weight:500;color:var(--text-muted);
  cursor:pointer;white-space:nowrap;transition:all .2s;flex-shrink:0;}
.filter-tab.active{background:rgba(74,222,128,.12);border-color:rgba(74,222,128,.3);
  color:var(--leaf-light);}
.filter-tab:hover{border-color:rgba(74,222,128,.2);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INSIGHTS PAGE STYLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.insight-card{margin:20px 20px 0;background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r);padding:20px;position:relative;overflow:hidden;}
.insight-card::before{content:'';position:absolute;top:-40px;right:-40px;width:120px;height:120px;
  background:radial-gradient(circle,rgba(34,197,94,.06) 0%,transparent 70%);}
.insight-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
.insight-title{font-size:14px;font-weight:600;color:var(--text-pri);}
.insight-value{font-family:'Fraunces',serif;font-size:28px;font-weight:700;
  background:linear-gradient(135deg,#f87171,#fb923c);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.insight-chart{display:flex;gap:12px;align-items:flex-end;height:140px;}
.chart-bar{flex:1;background:rgba(255,255,255,.03);border-radius:8px;
  display:flex;align-items:flex-end;justify-content:center;padding:8px;
  position:relative;transition:all .3s;cursor:pointer;}
.chart-bar:hover{background:rgba(74,222,128,.08);}
.chart-bar.active{background:linear-gradient(180deg,rgba(248,113,113,.15),rgba(251,146,60,.1));}
.chart-bar span{font-size:10px;color:var(--text-muted);text-align:center;line-height:1.3;}

.category-list{padding:0 20px;}
.category-item{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r);
  padding:16px 18px;margin-bottom:12px;display:flex;align-items:center;gap:14px;}
.cat-icon{width:46px;height:46px;border-radius:14px;display:flex;align-items:center;
  justify-content:center;font-size:22px;flex-shrink:0;
  background:rgba(74,222,128,.08);border:1px solid rgba(74,222,128,.2);}
.cat-info{flex:1;min-width:0;}
.cat-name{font-size:14px;font-weight:600;color:var(--text-pri);margin-bottom:6px;}
.cat-bar{height:6px;background:rgba(255,255,255,.03);border-radius:4px;overflow:hidden;}
.cat-bar-fill{height:100%;border-radius:4px;transition:width .6s cubic-bezier(.4,0,.2,1);}
.cat-value{text-align:right;}
.cat-carbon{font-size:15px;font-weight:700;color:var(--text-pri);margin-bottom:2px;}
.cat-percent{font-size:11px;color:var(--text-muted);}

.comparison-card{margin:0 20px 16px;background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r);padding:20px;position:relative;overflow:hidden;}
.comparison-card::before{content:'';position:absolute;top:-40px;right:-40px;width:120px;height:120px;
  background:radial-gradient(circle,rgba(34,197,94,.06) 0%,transparent 70%);}
.comp-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
.comp-title{font-size:14px;font-weight:600;color:var(--text-pri);}
.comp-badge{padding:4px 12px;border-radius:8px;font-size:11px;font-weight:600;}
.comp-badge.good{background:rgba(74,222,128,.15);color:var(--leaf-light);
  border:1px solid rgba(74,222,128,.3);}
.comp-bars{margin-bottom:16px;}
.comp-bar-row{display:flex;align-items:center;gap:10px;margin-bottom:12px;}
.comp-bar-row:last-child{margin-bottom:0;}
.comp-label{width:60px;font-size:13px;color:var(--text-muted);}
.comp-bar{flex:1;height:24px;background:rgba(255,255,255,.03);border-radius:8px;overflow:hidden;}
.comp-bar-fill{height:100%;border-radius:8px;transition:width .6s cubic-bezier(.4,0,.2,1);}
.comp-bar-fill.yours{background:linear-gradient(90deg,#22c55e,#4ade80);}
.comp-bar-fill.avg{background:linear-gradient(90deg,#fb923c,#fbbf24);}
.comp-val{width:60px;text-align:right;font-size:13px;font-weight:600;color:var(--text-pri);}
.comp-tip{font-size:12px;color:var(--text-muted);line-height:1.5;
  background:rgba(74,222,128,.06);border-radius:10px;padding:10px;}

.achievement-grid{padding:0 20px;display:grid;grid-template-columns:repeat(2,1fr);gap:12px;}
.achievement-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r);
  padding:16px;text-align:center;position:relative;overflow:hidden;transition:all .2s;}
.achievement-card.earned{border-color:rgba(74,222,128,.3);background:rgba(74,222,128,.04);}
.achievement-card:not(.earned){opacity:.5;}
.achievement-card::before{content:'';position:absolute;top:-30px;right:-30px;width:80px;height:80px;
  background:radial-gradient(circle,rgba(34,197,94,.06) 0%,transparent 70%);}
.ach-icon{font-size:36px;margin-bottom:8px;}
.ach-name{font-size:13px;font-weight:600;color:var(--text-pri);margin-bottom:4px;}
.ach-desc{font-size:10px;color:var(--text-muted);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROFILE PAGE STYLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.profile-header{margin:20px 20px 0;background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r);padding:20px;display:flex;align-items:center;gap:16px;position:relative;overflow:hidden;}
.profile-header::before{content:'';position:absolute;top:-40px;right:-40px;width:120px;height:120px;
  background:radial-gradient(circle,rgba(34,197,94,.06) 0%,transparent 70%);}
.profile-avatar{width:64px;height:64px;border-radius:18px;
  background:linear-gradient(135deg,#16a34a,#4ade80);
  display:flex;align-items:center;justify-content:center;flex-shrink:0;
  box-shadow:0 0 20px rgba(74,222,128,.3);}
.profile-avatar svg{color:var(--text-pri);}
.profile-info{flex:1;min-width:0;}
.profile-name{font-size:18px;font-weight:700;color:var(--text-pri);margin-bottom:4px;}
.profile-email{font-size:12px;color:var(--text-muted);}
.edit-btn{padding:8px 16px;background:rgba(74,222,128,.1);border:1px solid rgba(74,222,128,.25);
  border-radius:10px;font-size:13px;font-weight:600;color:var(--leaf-light);
  cursor:pointer;transition:all .2s;}
.edit-btn:hover{background:rgba(74,222,128,.15);transform:translateY(-1px);}

.profile-stats{padding:0 20px;margin-top:16px;display:grid;grid-template-columns:repeat(3,1fr);gap:12px;}
.stat-box{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r);
  padding:16px;text-align:center;position:relative;overflow:hidden;}
.stat-box::before{content:'';position:absolute;top:-30px;right:-30px;width:80px;height:80px;
  background:radial-gradient(circle,rgba(34,197,94,.06) 0%,transparent 70%);}
.stat-icon{font-size:28px;margin-bottom:8px;}
.stat-num{font-family:'Fraunces',serif;font-size:24px;font-weight:700;color:var(--text-pri);margin-bottom:4px;}
.stat-label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.6px;}

.menu-list{padding:0 20px;}
.menu-item{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--r);
  padding:16px 18px;margin-bottom:10px;display:flex;align-items:center;gap:14px;
  cursor:pointer;position:relative;overflow:hidden;transition:all .2s;}
.menu-item:hover{border-color:rgba(74,222,128,.25);box-shadow:0 4px 16px rgba(0,0,0,.25);}
.menu-icon{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;
  justify-content:center;font-size:20px;flex-shrink:0;
  background:rgba(74,222,128,.08);border:1px solid rgba(74,222,128,.2);}
.menu-text{flex:1;min-width:0;}
.menu-title{font-size:14px;font-weight:600;color:var(--text-pri);margin-bottom:2px;}
.menu-subtitle{font-size:11px;color:var(--text-muted);}
.menu-arrow{font-size:24px;color:var(--text-muted);font-weight:300;}

.logout-btn{width:calc(100% - 40px);margin:20px 20px 0;padding:16px;
  background:rgba(248,113,113,.1);border:1px solid rgba(248,113,113,.25);
  border-radius:16px;font-size:15px;font-weight:600;color:#f87171;
  cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;
  transition:all .2s;}
.logout-btn:hover{background:rgba(248,113,113,.15);transform:translateY(-1px);}
</style>
</head>
<body>

<!-- Carbon particles background -->
<div class="carbon-field" id="carbonField"></div>

<div class="app">
  <div class="pages">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         HOME PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page active" id="homePage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
          </div>
          CarbonCash
        </div>
        <button class="qr-btn" id="qrBtn" title="Scan QR Code">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" stroke="none">
            <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zM3 21h8v-8H3v8zm2-6h4v4H5v-4zM13 3v8h8V3h-8zm6 6h-4V5h4v4zM13 13h2v2h-2zM15 15h2v2h-2zM13 17h2v2h-2zM17 13h2v2h-2zM19 15h2v2h-2zM17 17h2v2h-2zM19 19h2v2h-2z"/>
          </svg>
        </button>
      </div>

      <div class="greeting">
        <div class="sub">Track Your Impact</div>
        <div class="name">Carbon Footprint</div>
      </div>

      <!-- Goal Setting & Green Points -->
      <div class="goal-setting-card">
        <div class="goal-setting-header">
          <div class="goal-setting-left">
            <div class="goal-setting-title">Weekly Carbon Goal</div>
            <div class="goal-setting-subtitle">Set your target and earn points</div>
          </div>
          <button class="set-goal-btn" id="setGoalBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            Edit
          </button>
        </div>
        <div class="goal-display">
          <div class="goal-amount-display">
            <span class="goal-value" id="goalValue">8.0</span>
            <span class="goal-unit">kg COâ‚‚</span>
          </div>
          <div class="green-points-badge">
            <div class="gp-icon">ğŸŒŸ</div>
            <div class="gp-info">
              <div class="gp-value" id="greenPoints">0</div>
              <div class="gp-label">Green Points</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Goal Status Alert -->
      <div class="goal-status-alert hidden" id="goalStatusAlert">
        <div class="goal-status-content">
          <div class="goal-status-icon" id="goalStatusIcon">ğŸ‰</div>
          <div class="goal-status-text">
            <div class="goal-status-title" id="goalStatusTitle">Goal Achieved!</div>
            <div class="goal-status-message" id="goalStatusMessage">You earned 50 Green Points</div>
          </div>
        </div>
      </div>

      <!-- Carbon Impact Card -->
      <div class="impact-card">
        <div class="impact-header">
          <div class="impact-left">
            <div class="impact-label">This Week's Carbon</div>
            <div class="carbon-amount">
              <span id="weekCarbon">0.0</span>
              <span class="unit">kg COâ‚‚</span>
            </div>
          </div>
          <div class="goal-ring">
            <svg width="68" height="68" viewBox="0 0 68 68">
              <circle cx="34" cy="34" r="30" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="6"/>
              <circle id="goalCircle" cx="34" cy="34" r="30" fill="none" stroke="url(#goalGradient)" stroke-width="6"
                stroke-dasharray="188.5" stroke-dashoffset="188.5" stroke-linecap="round"/>
              <defs>
                <linearGradient id="goalGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#f87171"/>
                  <stop offset="50%" style="stop-color:#fb923c"/>
                  <stop offset="100%" style="stop-color:#fbbf24"/>
                </linearGradient>
              </defs>
            </svg>
            <div class="goal-ring-label">
              <span>0%</span>
              <small>of goal</small>
            </div>
          </div>
        </div>
        <div class="goal-info">
          <div class="goal-icon">ğŸ¯</div>
          <div class="goal-text">
            <div class="main">8.0 kg away from your Green Goal</div>
            <div class="sub">Weekly target: 8kg COâ‚‚</div>
          </div>
        </div>
      </div>

      <!-- Weekly Goal Progress -->
      <div class="weekly-card" style="margin-top: 24px;">
        <div class="weekly-header">
          <div class="weekly-title">Remaining Budget</div>
          <div class="weekly-badge" id="weeklyBadge">On Track</div>
        </div>
        <div class="weekly-progress">
          <div class="weekly-progress-bar" id="weeklyProgressBar" style="width: 100%;"></div>
        </div>
        <div class="weekly-stats">
          <div class="weekly-stat">
            <div class="val" id="weeklyRemaining">8.0 kg</div>
            <div class="lbl">Remaining</div>
          </div>
          <div class="weekly-stat current">
            <div class="val" id="weeklyUsed">0.0 kg</div>
            <div class="lbl">Used</div>
          </div>
          <div class="weekly-stat goal">
            <div class="val" id="weeklyGoalDisplay">8.0 kg</div>
            <div class="lbl">Goal</div>
          </div>
        </div>
      </div>

      <!-- Recent Transactions -->
      <div class="section-title">Recent Transactions</div>
      <div class="txn-list" id="homeTxnList">
        <div id="homeEmptyState" style="text-align:center;padding:40px 20px;color:var(--text-muted);">
          <div style="font-size:48px;margin-bottom:12px;">ğŸ“±</div>
          <div style="font-size:14px;margin-bottom:4px;">No transactions yet</div>
          <div style="font-size:12px;">Tap the QR button to simulate a purchase</div>
        </div>
      </div>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         TRANSACTIONS PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="transactionsPage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
          </div>
          CarbonCash
        </div>
        <button class="qr-btn" id="qrBtn2" title="Scan QR Code">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" stroke="none">
            <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zM3 21h8v-8H3v8zm2-6h4v4H5v-4zM13 3v8h8V3h-8zm6 6h-4V5h4v4zM13 13h2v2h-2zM15 15h2v2h-2zM13 17h2v2h-2zM17 13h2v2h-2zM19 15h2v2h-2zM17 17h2v2h-2zM19 19h2v2h-2z"/>
          </svg>
        </button>
      </div>

      <div class="greeting">
        <div class="sub">All Your Purchases</div>
        <div class="name">Transactions</div>
      </div>

      <!-- Filter tabs -->
      <div class="filter-tabs">
        <button class="filter-tab active" data-filter="all">All</button>
        <button class="filter-tab" data-filter="high">High Impact</button>
        <button class="filter-tab" data-filter="medium">Medium</button>
        <button class="filter-tab" data-filter="low">Low Impact</button>
      </div>

      <div class="section-title">This Week</div>
      <div class="txn-list" id="transactionsTxnList">
        <div id="txnsEmptyState" style="text-align:center;padding:40px 20px;color:var(--text-muted);">
          <div style="font-size:48px;margin-bottom:12px;">ğŸ“±</div>
          <div style="font-size:14px;margin-bottom:4px;">No transactions yet</div>
          <div style="font-size:12px;">Tap the QR button to simulate a purchase</div>
        </div>
      </div>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         INSIGHTS PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="insightsPage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
          </div>
          CarbonCash
        </div>
        <button class="qr-btn" id="qrBtn3" title="Scan QR Code">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" stroke="none">
            <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zM3 21h8v-8H3v8zm2-6h4v4H5v-4zM13 3v8h8V3h-8zm6 6h-4V5h4v4zM13 13h2v2h-2zM15 15h2v2h-2zM13 17h2v2h-2zM17 13h2v2h-2zM19 15h2v2h-2zM17 17h2v2h-2zM19 19h2v2h-2z"/>
          </svg>
        </button>
      </div>

      <div class="greeting">
        <div class="sub">Environmental Analytics</div>
        <div class="name">Insights</div>
      </div>

      <!-- Monthly Overview -->
      <div class="insight-card">
        <div class="insight-header">
          <div class="insight-title">Monthly Carbon Footprint</div>
          <div class="insight-value">24.8 kg COâ‚‚</div>
        </div>
        <div class="insight-chart">
          <div class="chart-bar" style="height:60%;"><span>Week 1<br>5.2kg</span></div>
          <div class="chart-bar" style="height:75%;"><span>Week 2<br>7.1kg</span></div>
          <div class="chart-bar" style="height:85%;"><span>Week 3<br>6.4kg</span></div>
          <div class="chart-bar active" style="height:95%;"><span>Week 4<br>6.1kg</span></div>
        </div>
      </div>

      <!-- Category Breakdown -->
      <div class="section-title">Carbon by Category</div>
      <div class="category-list">
        <div class="category-item">
          <div class="cat-icon">ğŸš—</div>
          <div class="cat-info">
            <div class="cat-name">Transportation</div>
            <div class="cat-bar"><div class="cat-bar-fill" style="width:75%;background:linear-gradient(90deg,#f87171,#fb923c);"></div></div>
          </div>
          <div class="cat-value"><div class="cat-carbon">52.4 kg</div><div class="cat-percent">45%</div></div>
        </div>
        <div class="category-item">
          <div class="cat-icon">ğŸ•</div>
          <div class="cat-info">
            <div class="cat-name">Food & Dining</div>
            <div class="cat-bar"><div class="cat-bar-fill" style="width:60%;background:linear-gradient(90deg,#fb923c,#fbbf24);"></div></div>
          </div>
          <div class="cat-value"><div class="cat-carbon">38.2 kg</div><div class="cat-percent">33%</div></div>
        </div>
        <div class="category-item">
          <div class="cat-icon">ğŸ‘•</div>
          <div class="cat-info">
            <div class="cat-name">Shopping</div>
            <div class="cat-bar"><div class="cat-bar-fill" style="width:40%;background:linear-gradient(90deg,#fbbf24,#4ade80);"></div></div>
          </div>
          <div class="cat-value"><div class="cat-carbon">18.6 kg</div><div class="cat-percent">16%</div></div>
        </div>
        <div class="category-item">
          <div class="cat-icon">ğŸ’¡</div>
          <div class="cat-info">
            <div class="cat-name">Utilities</div>
            <div class="cat-bar"><div class="cat-bar-fill" style="width:20%;background:linear-gradient(90deg,#4ade80,#22c55e);"></div></div>
          </div>
          <div class="cat-value"><div class="cat-carbon">6.8 kg</div><div class="cat-percent">6%</div></div>
        </div>
      </div>

      <!-- Comparison Card -->
      <div class="section-title">Your Impact</div>
      <div class="comparison-card">
        <div class="comp-header">
          <div class="comp-title">vs Average User</div>
          <div class="comp-badge good">28% Better</div>
        </div>
        <div class="comp-bars">
          <div class="comp-bar-row">
            <div class="comp-label">You</div>
            <div class="comp-bar"><div class="comp-bar-fill yours" style="width:72%;"></div></div>
            <div class="comp-val">24.8 kg</div>
          </div>
          <div class="comp-bar-row">
            <div class="comp-label">Average</div>
            <div class="comp-bar"><div class="comp-bar-fill avg" style="width:100%;"></div></div>
            <div class="comp-val">34.5 kg</div>
          </div>
        </div>
        <div class="comp-tip">ğŸŒŸ You're doing great! Your carbon footprint is significantly lower than average.</div>
      </div>

      <!-- Achievements -->
      <div class="section-title">Achievements</div>
      <div class="achievement-grid">
        <div class="achievement-card earned">
          <div class="ach-icon">ğŸŒ±</div>
          <div class="ach-name">Eco Starter</div>
          <div class="ach-desc">First week tracked</div>
        </div>
        <div class="achievement-card earned">
          <div class="ach-icon">ğŸ¯</div>
          <div class="ach-name">Goal Getter</div>
          <div class="ach-desc">Met weekly goal</div>
        </div>
        <div class="achievement-card earned">
          <div class="ach-icon">ğŸš´</div>
          <div class="ach-name">Green Commuter</div>
          <div class="ach-desc">5 eco-friendly trips</div>
        </div>
        <div class="achievement-card">
          <div class="ach-icon">ğŸŒ</div>
          <div class="ach-name">Planet Hero</div>
          <div class="ach-desc">Offset 100kg COâ‚‚</div>
        </div>
      </div>
      <div style="height:20px;"></div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PROFILE PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="profilePage">
      <div class="header">
        <div class="logo">
          <div class="logo-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
          </div>
          CarbonCash
        </div>
        <button class="qr-btn" id="qrBtn4" title="Scan QR Code">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" stroke="none">
            <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zM3 21h8v-8H3v8zm2-6h4v4H5v-4zM13 3v8h8V3h-8zm6 6h-4V5h4v4zM13 13h2v2h-2zM15 15h2v2h-2zM13 17h2v2h-2zM17 13h2v2h-2zM19 15h2v2h-2zM17 17h2v2h-2zM19 19h2v2h-2z"/>
          </svg>
        </button>
      </div>

      <div class="greeting">
        <div class="sub">Your Account</div>
        <div class="name">Profile</div>
      </div>

      <div class="profile-header">
        <div class="profile-avatar">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
          </svg>
        </div>
        <div class="profile-info">
          <div class="profile-name">Priya Sharma</div>
          <div class="profile-email">priya@carboncash.in</div>
        </div>
        <button class="edit-btn" id="editProfileBtn">Edit</button>
      </div>

      <div class="profile-stats">
        <div class="stat-box">
          <div class="stat-icon">ğŸŒ±</div>
          <div class="stat-num" id="profileTotalCarbon">0</div>
          <div class="stat-label">Total COâ‚‚ (kg)</div>
        </div>
        <div class="stat-box">
          <div class="stat-icon">ğŸ¯</div>
          <div class="stat-num">12</div>
          <div class="stat-label">Goals Met</div>
        </div>
        <div class="stat-box">
          <div class="stat-icon">ğŸ†</div>
          <div class="stat-num">8</div>
          <div class="stat-label">Achievements</div>
        </div>
      </div>

      <div class="section-title">Settings</div>
      <div class="menu-list">
        <div class="menu-item"><div class="menu-icon">ğŸ¯</div><div class="menu-text"><div class="menu-title">Carbon Goals</div><div class="menu-subtitle">Set your weekly targets</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ””</div><div class="menu-text"><div class="menu-title">Notifications</div><div class="menu-subtitle">Manage alerts & reminders</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ”—</div><div class="menu-text"><div class="menu-title">Linked Accounts</div><div class="menu-subtitle">3 cards connected</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸŒ</div><div class="menu-text"><div class="menu-title">Offset Programs</div><div class="menu-subtitle">Plant trees & support projects</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ“Š</div><div class="menu-text"><div class="menu-title">Export Data</div><div class="menu-subtitle">Download your carbon history</div></div><div class="menu-arrow">â€º</div></div>
      </div>

      <div class="section-title">Support</div>
      <div class="menu-list">
        <div class="menu-item"><div class="menu-icon">â“</div><div class="menu-text"><div class="menu-title">Help & FAQ</div><div class="menu-subtitle">Get answers to common questions</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ’¬</div><div class="menu-text"><div class="menu-title">Contact Support</div><div class="menu-subtitle">We're here to help</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">â­</div><div class="menu-text"><div class="menu-title">Rate CarbonCash</div><div class="menu-subtitle">Share your feedback</div></div><div class="menu-arrow">â€º</div></div>
      </div>

      <div class="section-title">Legal</div>
      <div class="menu-list">
        <div class="menu-item"><div class="menu-icon">ğŸ“„</div><div class="menu-text"><div class="menu-title">Privacy Policy</div></div><div class="menu-arrow">â€º</div></div>
        <div class="menu-item"><div class="menu-icon">ğŸ“‹</div><div class="menu-text"><div class="menu-title">Terms of Service</div></div><div class="menu-arrow">â€º</div></div>
      </div>

      <button class="logout-btn" id="logoutBtn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"/>
        </svg>
        Log Out
      </button>
      <div style="height:20px;"></div>
    </div>

  </div>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <button class="nav-item active">
      <div class="nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
      </div>
      <div class="nav-label">Home</div>
    </button>
    <button class="nav-item">
      <div class="nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>
      </div>
      <div class="nav-label">Transactions</div>
    </button>
    <button class="nav-item">
      <div class="nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
      </div>
      <div class="nav-label">Insights</div>
    </button>
    <button class="nav-item">
      <div class="nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
      </div>
      <div class="nav-label">Profile</div>
    </button>
  </div>
</div>

<!-- QR Scan Feedback Banner (replaces notification popup) -->
<div class="scan-banner" id="scanBanner">
  <div class="scan-banner-icon" id="scanBannerIcon">âœ…</div>
  <div class="scan-banner-body">
    <div class="scan-banner-title" id="scanBannerTitle">Transaction Recorded</div>
    <div class="scan-banner-sub" id="scanBannerSub">+0.0 kg COâ‚‚ added to your tracker</div>
  </div>
</div>

<!-- Transaction Detail Modal -->
<div class="modal" id="txnModal">
  <div class="modal-sheet" id="txnModalSheet">
    <div class="modal-handle"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-icon-big high" id="modalIconBig">
          <span id="modalEmoji">â˜•</span>
        </div>
        <div class="modal-info">
          <h3 id="modalName">Starbucks Coffee</h3>
          <div class="cat" id="modalCat">Eating Places Â· MCC 5812</div>
        </div>
      </div>

      <div class="modal-row">
        <div class="label">Transaction Amount</div>
        <div class="value" id="modalAmount">â‚¹450</div>
      </div>
      <div class="modal-row">
        <div class="label">Carbon Footprint</div>
        <div class="value carbon" id="modalCarbon">0.8 kg COâ‚‚</div>
      </div>
      <div class="modal-row">
        <div class="label">Transaction Date</div>
        <div class="value" id="modalDate">Feb 14, 2026 Â· 2:34 PM</div>
      </div>

      <div class="modal-divider"></div>

      <div class="carbon-breakdown" id="carbonBreakdown">
        <div class="breakdown-title">Carbon Breakdown</div>
      </div>

      <div class="tip-box">
        <div class="tip-icon">ğŸ’¡</div>
        <div class="tip-text" id="modalTip">
          <strong>Eco Tip:</strong> Small choices add up. Consider greener alternatives to reduce your carbon footprint.
        </div>
      </div>

      <button class="modal-close" id="modalCloseBtn">Close</button>
    </div>
  </div>
</div>

<!-- Goal Setting Modal -->
<div class="modal" id="goalModal">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-icon-big" style="background:linear-gradient(135deg,rgba(74,222,128,.2),rgba(34,197,94,.2));border:1.5px solid rgba(74,222,128,.35);">
          <span>ğŸ¯</span>
        </div>
        <div class="modal-info">
          <h3>Set Weekly Goal</h3>
          <div class="cat">Choose your carbon limit</div>
        </div>
      </div>

      <div style="margin:20px 0;">
        <div style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">Target Carbon Footprint (kg COâ‚‚)</div>
        <input type="number" id="goalInput" class="goal-input" min="1" max="100" step="0.5" value="8.0" placeholder="8.0">
        <div class="goal-suggestions">
          <button class="goal-suggest-btn" data-goal="5">5 kg â€“ Strict</button>
          <button class="goal-suggest-btn" data-goal="8">8 kg â€“ Moderate</button>
          <button class="goal-suggest-btn" data-goal="12">12 kg â€“ Flexible</button>
        </div>
      </div>

      <div class="tip-box" style="margin-bottom:20px;">
        <div class="tip-icon">ğŸ’¡</div>
        <div class="tip-text">
          <strong>How it works:</strong> Stay under your weekly carbon goal to earn 50 Green Points. Exceed it and you'll need to try again next week!
        </div>
      </div>

      <div style="display:flex;gap:12px;">
        <button class="modal-close" id="goalCancelBtn" style="background:rgba(255,255,255,.05);box-shadow:none;flex:1;">Cancel</button>
        <button class="modal-close" id="goalSaveBtn" style="flex:2;">Save Goal</button>
      </div>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CARBON PARTICLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const carbonField = document.getElementById('carbonField');
const carbonSymbols = ['COâ‚‚', 'ğŸŒ¿', 'â™»ï¸', 'ğŸŒ'];
for(let i = 0; i < 15; i++) {
  const p = document.createElement('div');
  p.className = 'carbon-particle';
  p.textContent = carbonSymbols[Math.floor(Math.random() * carbonSymbols.length)];
  p.style.left = Math.random() * 100 + '%';
  p.style.fontSize = (Math.random() * 12 + 16) + 'px';
  p.style.animationDuration = (Math.random() * 20 + 25) + 's';
  p.style.animationDelay = Math.random() * 15 + 's';
  p.style.color = 'rgba(74,222,128,0.2)';
  carbonField.appendChild(p);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let allTransactions = [];
let weeklyGoal = 8.0;
let greenPoints = 0;
let goalStatus = 'active';
let transactionCount = 0;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MERCHANT DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const sampleMerchants = [
  { emoji:'â˜•', name:'Starbucks Coffee', cat:'Eating Places', mcc:'5812', amount:()=>Math.floor(Math.random()*300+200), carbonFactor:1.8, impact:'high',
    tips:['Bring your own reusable cup to save ~0.10kg COâ‚‚ per visit.','Choosing plant-based milk reduces emissions by up to 30%!'] },
  { emoji:'ğŸ”', name:"McDonald's", cat:'Fast Food', mcc:'5814', amount:()=>Math.floor(Math.random()*250+150), carbonFactor:1.5, impact:'medium',
    tips:['Try a plant-based burger to cut your meal\'s carbon footprint by 50%.','Dining in uses fewer single-use plastics than takeaway.'] },
  { emoji:'ğŸ›’', name:'DMart Grocery', cat:'Grocery Store', mcc:'5411', amount:()=>Math.floor(Math.random()*1000+500), carbonFactor:0.3, impact:'low',
    tips:['Buying local and seasonal produce reduces supply chain emissions.','Bring reusable bags to eliminate plastic waste.'] },
  { emoji:'â›½', name:'Indian Oil Petrol', cat:'Gas Station', mcc:'5541', amount:()=>Math.floor(Math.random()*1500+1000), carbonFactor:2.5, impact:'high',
    tips:['Consider carpooling or public transit to halve your transport emissions.','EVs emit ~70% less COâ‚‚ per km than petrol vehicles.'] },
  { emoji:'ğŸ•', name:"Domino's Pizza", cat:'Restaurant', mcc:'5812', amount:()=>Math.floor(Math.random()*400+300), carbonFactor:1.4, impact:'medium',
    tips:['Vegetarian pizzas have roughly 40% lower carbon footprint.','Ordering in bulk for one delivery beats multiple small orders.'] },
  { emoji:'ğŸ‘•', name:'Zara Fashion', cat:'Clothing Store', mcc:'5691', amount:()=>Math.floor(Math.random()*2000+1000), carbonFactor:0.8, impact:'high',
    tips:['One garment produces ~2.1kg COâ‚‚. Buying second-hand saves 80%.','Washing clothes in cold water cuts energy use by 90%.'] },
  { emoji:'ğŸ¬', name:'PVR Cinemas', cat:'Entertainment', mcc:'7832', amount:()=>Math.floor(Math.random()*500+300), carbonFactor:0.4, impact:'low',
    tips:['Cinema visits are one of the lower-impact entertainment choices.','Choosing nearby venues reduces your travel emissions.'] },
  { emoji:'ğŸ‹ï¸', name:'Cult.fit Gym', cat:'Health & Fitness', mcc:'7997', amount:()=>Math.floor(Math.random()*1500+1000), carbonFactor:0.2, impact:'low',
    tips:['Working out at a gym has a lower footprint than driving to outdoor activities.','Ask about the gym\'s renewable energy usage!'] }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const pageIds = ['homePage','transactionsPage','insightsPage','profilePage'];

function navigateToPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  setTimeout(() => {
    document.getElementById(pageId).classList.add('active');
  }, 50);
  document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
  const idx = pageIds.indexOf(pageId);
  document.querySelectorAll('.nav-item')[idx]?.classList.add('active');
}

document.querySelectorAll('.nav-item').forEach((item, index) => {
  item.addEventListener('click', () => navigateToPage(pageIds[index]));
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRANSACTION GENERATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function generateTransaction() {
  const merchant = sampleMerchants[Math.floor(Math.random() * sampleMerchants.length)];
  const amount = merchant.amount();
  const carbon = parseFloat(((amount / 1000) * merchant.carbonFactor).toFixed(1));
  const now = new Date();
  const timeStr = now.toLocaleTimeString('en-US', { hour:'2-digit', minute:'2-digit', hour12:true });
  const dateStr = now.toLocaleDateString('en-US', { month:'short', day:'numeric', year:'numeric' });

  const txn = {
    id: 'txn_' + Date.now(),
    emoji: merchant.emoji,
    name: merchant.name,
    cat: merchant.cat,
    mcc: merchant.mcc,
    amount, carbon,
    impact: merchant.impact,
    time: timeStr,
    date: dateStr,
    fullDate: now,
    details: `MCC ${merchant.mcc} Â· ${merchant.cat} Â· Just now`,
    tip: merchant.tips[Math.floor(Math.random() * merchant.tips.length)]
  };

  allTransactions.unshift(txn);
  return txn;
}

function createTxnElement(txn) {
  const el = document.createElement('div');
  el.className = 'txn-item';
  el.setAttribute('data-txn', txn.id);
  el.setAttribute('data-impact', txn.impact);
  el.innerHTML = `
    <div class="txn-icon ${txn.impact}">${txn.emoji}</div>
    <div class="txn-info">
      <div class="txn-name">${txn.name}</div>
      <div class="txn-details">${txn.details}</div>
    </div>
    <div class="txn-right">
      <div class="txn-carbon ${txn.impact}">${txn.carbon} kg</div>
      <div class="txn-amount">â‚¹${txn.amount}</div>
    </div>
  `;
  el.addEventListener('click', function(e) {
    showTransactionModal(txn);
    const r = document.createElement('span');
    const rect = this.getBoundingClientRect();
    r.style.cssText = `position:absolute;border-radius:50%;background:rgba(74,222,128,.15);width:12px;height:12px;left:${e.clientX-rect.left}px;top:${e.clientY-rect.top}px;transform:translate(-50%,-50%) scale(0);animation:rippleAnim .5s ease-out forwards;pointer-events:none;z-index:99`;
    this.appendChild(r);
    setTimeout(() => r.remove(), 500);
  });
  return el;
}

function addTransactionToUI(txn) {
  // Home page
  const homeList = document.getElementById('homeTxnList');
  const homeEmpty = document.getElementById('homeEmptyState');
  if (homeEmpty) homeEmpty.remove();

  const homeEl = createTxnElement(txn);
  homeEl.style.opacity = '0';
  homeEl.style.transform = 'translateY(-20px)';
  homeList.insertBefore(homeEl, homeList.firstChild);
  setTimeout(() => {
    homeEl.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
    homeEl.style.opacity = '1';
    homeEl.style.transform = 'translateY(0)';
  }, 50);

  // Keep only 3 in home
  const homeItems = homeList.querySelectorAll('.txn-item');
  if (homeItems.length > 3) homeItems[homeItems.length - 1].remove();

  // Transactions page
  const txnsList = document.getElementById('transactionsTxnList');
  const txnsEmpty = document.getElementById('txnsEmptyState');
  if (txnsEmpty) txnsEmpty.remove();

  const txnsEl = createTxnElement(txn);
  txnsEl.style.opacity = '0';
  txnsEl.style.transform = 'translateY(-20px)';
  txnsList.insertBefore(txnsEl, txnsList.firstChild);
  setTimeout(() => {
    txnsEl.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
    txnsEl.style.opacity = '1';
    txnsEl.style.transform = 'translateY(0)';
  }, 50);

  // Reapply active filter
  const activeFilter = document.querySelector('.filter-tab.active');
  if (activeFilter) {
    const filter = activeFilter.getAttribute('data-filter');
    if (filter !== 'all') {
      txnsEl.style.display = txn.impact === filter ? 'flex' : 'none';
    }
  }

  updateWeeklyCarbon();
  transactionCount++;
  checkGoalStatus();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCAN BANNER (replaces notification popup)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let bannerTimeout;
function showScanBanner(txn) {
  const banner = document.getElementById('scanBanner');
  document.getElementById('scanBannerIcon').textContent = txn.emoji;
  document.getElementById('scanBannerTitle').textContent = `${txn.name} â€“ â‚¹${txn.amount}`;
  document.getElementById('scanBannerSub').textContent = `+${txn.carbon} kg COâ‚‚ added to your tracker`;
  banner.classList.add('show');
  clearTimeout(bannerTimeout);
  bannerTimeout = setTimeout(() => banner.classList.remove('show'), 3500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QR BUTTON HANDLER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function handleQRScan(e) {
  const btn = e.currentTarget;
  btn.style.transform = 'scale(0.9)';
  setTimeout(() => {
    btn.style.transform = '';
    const txn = generateTransaction();
    addTransactionToUI(txn);
    showScanBanner(txn);
    btn.style.boxShadow = '0 0 20px rgba(74,222,128,.6)';
    setTimeout(() => btn.style.boxShadow = '', 1000);
  }, 200);
}

document.getElementById('qrBtn').addEventListener('click', handleQRScan);
document.getElementById('qrBtn2').addEventListener('click', handleQRScan);
document.getElementById('qrBtn3').addEventListener('click', handleQRScan);
document.getElementById('qrBtn4').addEventListener('click', handleQRScan);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRANSACTION MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const txnModal = document.getElementById('txnModal');
const txnModalSheet = document.getElementById('txnModalSheet');

function showTransactionModal(txn) {
  document.getElementById('modalEmoji').textContent = txn.emoji;
  document.getElementById('modalName').textContent = txn.name;
  document.getElementById('modalCat').textContent = `${txn.cat} Â· MCC ${txn.mcc}`;
  document.getElementById('modalAmount').textContent = `â‚¹${txn.amount}`;
  document.getElementById('modalCarbon').textContent = `${txn.carbon} kg COâ‚‚`;
  document.getElementById('modalDate').textContent = `${txn.date} Â· ${txn.time}`;

  const iconEl = document.getElementById('modalIconBig');
  iconEl.className = `modal-icon-big ${txn.impact}`;

  const breakdown = [
    { name:'Product/Service Carbon', val:`${(txn.carbon * 0.6).toFixed(2)} kg` },
    { name:'Transportation & Logistics', val:`${(txn.carbon * 0.25).toFixed(2)} kg` },
    { name:'Operations & Energy', val:`${(txn.carbon * 0.15).toFixed(2)} kg` }
  ];
  document.getElementById('carbonBreakdown').innerHTML =
    `<div class="breakdown-title">Carbon Breakdown</div>` +
    breakdown.map(b => `<div class="breakdown-item"><div class="name">${b.name}</div><div class="val">${b.val}</div></div>`).join('');

  document.getElementById('modalTip').innerHTML = `<strong>Eco Tip:</strong> ${txn.tip}`;

  txnModal.classList.add('open');
  document.body.style.overflow = 'hidden';
}

document.getElementById('modalCloseBtn').addEventListener('click', closeModal);
txnModal.addEventListener('click', e => { if (e.target === txnModal) closeModal(); });

function closeModal() {
  txnModal.classList.remove('open');
  document.body.style.overflow = '';
}

// Swipe to close
let touchStartY = 0;
txnModalSheet.addEventListener('touchstart', e => { touchStartY = e.touches[0].clientY; }, {passive:true});
txnModalSheet.addEventListener('touchmove', e => {
  const dy = e.touches[0].clientY - touchStartY;
  if (dy > 0) txnModalSheet.style.transform = `translateY(${dy}px)`;
}, {passive:true});
txnModalSheet.addEventListener('touchend', e => {
  const dy = e.changedTouches[0].clientY - touchStartY;
  txnModalSheet.style.transform = '';
  if (dy > 80) closeModal();
}, {passive:true});

// Ripple animation
const ripStyle = document.createElement('style');
ripStyle.textContent = '@keyframes rippleAnim{to{transform:scale(14);opacity:0;}}';
document.head.appendChild(ripStyle);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GOAL SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateWeeklyCarbon() {
  const total = allTransactions.reduce((sum, t) => sum + t.carbon, 0);
  document.getElementById('weekCarbon').textContent = total.toFixed(1);

  const percentUsed = Math.min((total / weeklyGoal) * 100, 100);
  const circumference = 188.5;
  const offset = circumference - (circumference * percentUsed / 100);
  document.getElementById('goalCircle').style.strokeDashoffset = offset;
  document.querySelector('.goal-ring-label span').textContent = Math.round(percentUsed) + '%';

  const remaining = Math.max(weeklyGoal - total, 0);
  document.querySelector('.goal-info .main').textContent = `${remaining.toFixed(1)} kg away from your Green Goal`;

  const percentRemaining = Math.max(0, ((weeklyGoal - total) / weeklyGoal) * 100);
  document.getElementById('weeklyProgressBar').style.width = `${percentRemaining}%`;

  const badge = document.getElementById('weeklyBadge');
  if (total >= weeklyGoal) {
    badge.textContent = 'Over Goal';
    badge.style.cssText = 'background:rgba(248,113,113,.15);color:#f87171;border-color:rgba(248,113,113,.3);';
  } else if (percentRemaining < 20) {
    badge.textContent = 'Almost There!';
    badge.style.cssText = 'background:rgba(251,191,36,.15);color:#fbbf24;border-color:rgba(251,191,36,.3);';
  } else {
    badge.textContent = 'On Track';
    badge.style.cssText = 'background:rgba(74,222,128,.1);color:#4ade80;border-color:rgba(74,222,128,.25);';
  }

  document.getElementById('weeklyRemaining').textContent = `${remaining.toFixed(1)} kg`;
  document.getElementById('weeklyUsed').textContent = `${total.toFixed(1)} kg`;
  document.getElementById('weeklyGoalDisplay').textContent = `${weeklyGoal.toFixed(1)} kg`;

  // Update profile total
  document.getElementById('profileTotalCarbon').textContent = total.toFixed(1);

  if (transactionCount >= 3 && total < weeklyGoal && goalStatus === 'active') {
    setTimeout(awardGreenPoints, 500);
  }
}

function checkGoalStatus() {
  const total = allTransactions.reduce((sum, t) => sum + t.carbon, 0);
  const alert = document.getElementById('goalStatusAlert');

  if (goalStatus === 'active') {
    if (total >= weeklyGoal) {
      goalStatus = 'failed';
      alert.classList.remove('hidden','success');
      alert.classList.add('failed');
      document.getElementById('goalStatusIcon').textContent = 'ğŸ˜¢';
      document.getElementById('goalStatusTitle').textContent = 'Goal Failed!';
      document.getElementById('goalStatusMessage').textContent = `You exceeded your ${weeklyGoal.toFixed(1)}kg goal. Try again next week!`;
      setTimeout(() => alert.classList.add('hidden'), 5000);
    }
  }
}

function awardGreenPoints() {
  const total = allTransactions.reduce((sum, t) => sum + t.carbon, 0);
  if (goalStatus === 'active' && total < weeklyGoal && transactionCount >= 3) {
    goalStatus = 'success';
    greenPoints += 50;
    document.getElementById('greenPoints').textContent = greenPoints;
    const alert = document.getElementById('goalStatusAlert');
    alert.classList.remove('hidden','failed');
    alert.classList.add('success');
    document.getElementById('goalStatusIcon').textContent = 'ğŸ‰';
    document.getElementById('goalStatusTitle').textContent = 'Goal Achieved!';
    document.getElementById('goalStatusMessage').textContent = 'You earned 50 Green Points! Keep up the great work!';
    const btn = document.getElementById('setGoalBtn');
    btn.style.transform = 'scale(1.1)';
    setTimeout(() => btn.style.transform = '', 300);
    setTimeout(() => alert.classList.add('hidden'), 6000);
  }
}

// Goal Modal
document.getElementById('setGoalBtn').addEventListener('click', () => {
  document.getElementById('goalInput').value = weeklyGoal.toFixed(1);
  document.getElementById('goalModal').classList.add('open');
  document.body.style.overflow = 'hidden';
});

document.querySelectorAll('.goal-suggest-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    document.getElementById('goalInput').value = parseFloat(this.getAttribute('data-goal')).toFixed(1);
  });
});

document.getElementById('goalSaveBtn').addEventListener('click', function() {
  const newGoal = parseFloat(document.getElementById('goalInput').value);
  if (newGoal && newGoal > 0 && newGoal <= 100) {
    weeklyGoal = newGoal;
    document.getElementById('goalValue').textContent = weeklyGoal.toFixed(1);
    goalStatus = 'active';
    document.getElementById('goalStatusAlert').classList.add('hidden');
    closeGoalModal();
    updateWeeklyCarbon();
    const orig = this.textContent;
    this.textContent = 'âœ“ Goal Saved!';
    this.style.opacity = '0.8';
    setTimeout(() => { this.textContent = orig; this.style.opacity = ''; }, 1500);
  } else {
    alert('Please enter a valid goal between 1 and 100 kg COâ‚‚');
  }
});

document.getElementById('goalCancelBtn').addEventListener('click', closeGoalModal);
document.getElementById('goalModal').addEventListener('click', e => {
  if (e.target === document.getElementById('goalModal')) closeGoalModal();
});

function closeGoalModal() {
  document.getElementById('goalModal').classList.remove('open');
  document.body.style.overflow = '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FILTER TABS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.filter-tab').forEach(tab => {
  tab.addEventListener('click', function() {
    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
    this.classList.add('active');
    const filter = this.getAttribute('data-filter');
    document.querySelectorAll('#transactionsTxnList .txn-item').forEach(item => {
      item.style.display = (filter === 'all' || item.getAttribute('data-impact') === filter) ? 'flex' : 'none';
    });
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILE INTERACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.menu-item').forEach(item => {
  item.addEventListener('click', function() {
    const title = this.querySelector('.menu-title')?.textContent;
    if (title) alert(`Opening: ${title}`);
  });
});

document.getElementById('editProfileBtn').addEventListener('click', () => {
  alert('Edit profile feature coming soon!');
});

document.getElementById('logoutBtn').addEventListener('click', () => {
  if (confirm('Are you sure you want to log out?')) alert('Logging outâ€¦');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
setTimeout(updateWeeklyCarbon, 100);
</script>
</body>
</html>
